(function(j){var l={KnotVariants:{},Setting:{enablePropertyHook:!0},Log:{Level:{Info:"Info",Warning:"Warning",Error:"Error"},log:function(g,i,e){j.console&&(j.console.log("["+g+"]"+i),e&&j.console.log(e))},info:function(g,i){this.log(this.Level.Info,g,i)},warning:function(g,i){this.log(this.Level.Warning,g,i)},error:function(g,i){this.log(this.Level.Error,g,i)}},Debugger:{knotChanged:function(){},knotTied:function(){},knotUntied:function(){},nodeAdded:function(){},nodeRemoved:function(){},errorStatusChanged:function(){}}};
j.Knot={K1M:function(){return l}}})(window);(function(j){var l=j.Knot.K1M(),g={"(":!0,"{":!0,"[":!0},i={")":!0,"}":!0,"]":!0},e={"(":")","{":"}","[":"]"};l.K1F={K1H:function(d){for(var c in d)return!1;return!0},trim:function(d){return d.trim?d.trim():d.replace(/^\s+|\s+$/g,"")},K1G:function(d,c){return!d?!1:d.substr(0,c.length)===c},getValueOnPath:function(d,c){if(!c&&""!==c||"*NULL"===c)return null;if("*"===c||""===c)return d;if("'"===c[0]&&"'"===c[c.length-1])return c.substr(1,c.length-2);var e=!1;"@"===c[0]&&
(e=!0,c=c.substr(1));var a;if(this.K1G(c,"__knot_global"))a=l.KS.KV(c);else{var b=d;"/"===c[0]?(b=j,c=c.substr(1)):"$"===c[0]&&(b=l.KnotVariants,c=c.substr(1));for(;0<=c.indexOf(".")&&b;)var h=l.K1F.trim(c.substr(0,c.indexOf("."))),b="*"!==h?b[h]:void 0,c=l.K1F.trim(c.substr(c.indexOf(".")+1));"*"===c?a=b:b&&(a=b[c])}if(e&&a&&"function"!==typeof a)l.Log.error("'"+c+"' is expected as a function, but it isn't.");else return a},setValueOnPath:function(e,c,f){if("*"!==
c[c.length-1]){if(this.K1G(c,"__knot_global"))throw Error("Can't set global symbol!");c&&"/"===c[0]?(e=j,c=c.substr(1)):"$"===c[0]&&(e=l.KnotVariants,c=c.substr(1));var a=c,b=c.lastIndexOf(".");0<b&&(a=c.substr(b+1),e=this.getValueOnPath(e,c.substr(0,b)));e&&(e[a]=f)}},K1I:function(){return j.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},K1J:function(e,c,f,a){var b={start:-1,end:-1};b.start=e.indexOf(f,c);if(0>b.start)return null;for(var c=0,h=b.start+
1;;){var k=e.indexOf(f,h),h=e.indexOf(a,h);if(0>h)break;if(0>k||h<k){if(0===c){b.end=h;break}else c--;h+=1}else c++,h=k+1}return 0<=b.start&&0<=b.end?b:null},K1K:function(d,c){for(var f=0,a=0,b=[],h=[],k=c.length;f<d.length;){if(g[d[f]])h.push(d[f]);else if(i[d[f]]){var m=h.pop();e[m]!==d[f]&&(l.Log.warning("Unclosed block is detected.\r"+d),h.push(m))}else 0===h.length&&(d[f]===c[0]&&d.substr(f,k)===c)&&(b.push(d.substr(a,f-a)),a=f+k);f++}0<h.length&&l.Log.warning("Unclosed block is detected.\r"+
d);f>=a&&b.push(d.substr(a,f-a));return b}}})(window);(function(j){j=j.Knot.K1M();j.Deferred=function(){this._succCallbacks=[];this._errCallbacks=[];this.isRejected=this.isFinished=!1;this.result=null};j.Deferred.prototype.resolve=function(l){this.result=l;this.isFinished=!0;this.isRejected=!1;for(var g=0;g<this._succCallbacks.length;g++)this._succCallbacks[g](l)};j.Deferred.prototype.reject=function(l){this.result=l;this.isRejected=this.isFinished=!0;for(var g=0;g<this._errCallbacks.length;g++)this._errCallbacks[g](l)};j.Deferred.prototype.done=
function(l,g){this.isFinished?this.isRejected?g(this.result):l(this.result):(this._succCallbacks.push(l),this._errCallbacks.push(g));return this}})(window);(function(j){var l=j.Knot.K1M();l.KJ={_dataInMonitoring:[],_attachedInfoOfData:[],KK:function(g){if(l.Setting.enablePropertyHook){if(!g.__knot_attachedData){if("object"!==typeof g)throw Error("Can only monitor object or array!");Object.defineProperty(g,"__knot_attachedData",{value:{},configurable:!0,writable:!1,enumerable:!1})}return g.__knot_attachedData}0>this._dataInMonitoring.indexOf(g)&&(this._dataInMonitoring.push(g),this._attachedInfoOfData[this._dataInMonitoring.indexOf(g)]=
{});return this._attachedInfoOfData[this._dataInMonitoring.indexOf(g)]},KL:function(g){l.Setting.enablePropertyHook?delete g.__knot_attachedData:(g=this._dataInMonitoring.indexOf(g),0<=g&&(delete this._dataInMonitoring[g],delete this._attachedInfoOfData[g]))}}})(window);(function(j){var l=j.Knot.K1M();l.KM={on:function(g,i,e,d){g=l.KJ.KK(g);g.K1O||(g.K1O={});i||(i="*");g.K1O[i]||(g.K1O[i]=[]);g.K1O[i].push({callback:e,attachedData:d})},off:function(g,i,e){i||(i="*");var d=l.KJ.KK(g);if(d.K1O&&d.K1O[i]){for(var c=0;c<d.K1O[i].length;c++)if(d.K1O[i][c].callback===e){d.K1O[i].splice(c,
1);break}0===d.K1O[i].length&&(delete d.K1O[i],l.K1F.K1H(d)&&l.KJ.KL(g))}},KN:function(g,i,e){g=l.KJ.KK(g);if(g.K1O&&g.K1O[i])for(var d=0;d<g.K1O[i].length;d++)if(g.K1O[i][d].callback===e)return!0;return!1},KO:function(g,i,e){g=l.KJ.KK(g);if(g.K1O&&g.K1O[i])for(var d=0;d<g.K1O[i].length;d++)if(g.K1O[i][d].callback===
e)return g.K1O[i][d].attachedData;return null},notifyDataChanged:function(g,i,e,d,c){var f=l.KJ.KK(g);f.changedProperties||(f.changedProperties=[]);0>f.changedProperties.indexOf(i)&&f.changedProperties.push(i);var a,b;if(f.K1O&&f.K1O[i]){a=f.K1O[i].slice(0);for(b=0;b<a.length;b++)try{a[b].callback.apply(g,[i,e,d,c])}catch(h){l.Log.warning("Call changed callback failed.",h)}}if(f.K1O&&f.K1O["*"]&&"*"!==
i){a=f.K1O["*"].slice(0);for(b=0;b<a.length;b++)try{a[b].callback.apply(g,[i,e,d,c])}catch(k){l.Log.warning("Call changed callback failed.",k)}}},getPropertiesChangeRecords:function(g){g=l.KJ.KK(g);return!g?null:g.changedProperties?g.changedProperties:[]},clearPropertiesChangeRecords:function(g){g=l.KJ.KK(g);if(!g)return null;g.changedProperties=null},KP:function(g,i){if("*"!==i){var e=l.KJ.KK(g);e.dataHookInfo||
(e.dataHookInfo={hookedProperties:[],data:{},hookRefCount:{}});if(0<=e.dataHookInfo.hookedProperties.indexOf(i))e.dataHookInfo.hookRefCount[i]++;else if(e.dataHookInfo.hookedProperties.push(i),e.dataHookInfo.data[i]=g[i],e.dataHookInfo.hookRefCount[i]=1,!(g instanceof Array&&"length"===i))try{Object.defineProperty(g,i,{set:function(c){var d=e.dataHookInfo.data[i];if(d!==c){e.dataHookInfo.data[i]=c;l.KM.notifyDataChanged(this,i,d,c)}},get:function(){return e.dataHookInfo.data[i]},configurable:!0,
enumerable:!0})}catch(d){e.dataHookInfo.hookFailed=!0,l.Log.warning("Hook property failed. property:"+i,d)}}},KQ:function(g,i){if("*"!==i){var e=l.KJ.KK(g);e.dataHookInfo&&(!(0>e.dataHookInfo.hookedProperties.indexOf(i))&&!(0<--e.dataHookInfo.hookRefCount[i]))&&(e.dataHookInfo.hookFailed||(delete g[i],g[i]=e.dataHookInfo.data[i]),e.dataHookInfo.hookedProperties.splice(e.dataHookInfo.hookedProperties.indexOf(i),1),delete e.dataHookInfo.data[i],delete e.dataHookInfo.hookRefCount[i])}},
KR:function(g,i){var e=l.KJ.KK(g);return!e.dataHookInfo?!1:0<=e.dataHookInfo.hookedProperties.indexOf(i)},monitorObject:function(g,i,e,d){var c,f=i.substr(0,i.indexOf("."));f?c=i.substr(i.indexOf(".")+1):(f=i,c=null);var a={};l.KM.on(g,i,e,a);c&&(a.childChangedCallback=function(a,h,k,e){l.KM.notifyDataChanged(g,f+"."+c,h,k,e)},a.monitorChildChangedCallback=function(b,h,k,e){h&&l.KM.stopMonitoring(h,c,a.childChangedCallback);k&&l.KM.monitorObject(k,
c,a.childChangedCallback,true);b=f+"."+c;k=l.K1F.getValueOnPath(k,c);h=l.K1F.getValueOnPath(h,c);l.KM.notifyDataChanged(g,b,h,k,e)},l.KM.on(g,f,a.monitorChildChangedCallback),g[f]&&l.KM.monitorObject(g[f],c,a.childChangedCallback,!0));d||(a.changedCallback=function(b,h,k){if(h instanceof Array){l.KM.off(h,"*",a.arrayChangedCallback);delete a.arrayChangedCallback}if(k instanceof Array){a.arrayChangedCallback=function(a,b,k,h){l.KM.notifyDataChanged(g,
i,k,k,h)};l.KM.on(k,"*",a.arrayChangedCallback)}},l.KM.on(g,i,a.changedCallback,a),e=l.K1F.getValueOnPath(g,i),e instanceof Array&&a.changedCallback("*",null,e));l.KM.KP(g,f)},monitor:function(g,i,e){if(i)"/"===i[0]&&(i=i.substr(1),g=j),this.monitorObject(g,i,e);else l.KM.on(g,null,e)},stopMonitoring:function(g,i,e){if(i){"/"===i[0]&&(i=i.substr(1),g=j);var d,c=i.substr(0,i.indexOf("."));c?d=i.substr(i.indexOf(".")+1):(c=i,d=null);var f=l.KM.KO(g,
i,e);f&&(f.monitorChildChangedCallback&&l.KM.off(g,c,f.monitorChildChangedCallback),f.childChangedCallback&&g[c]&&l.KM.stopMonitoring(g[c],d,f.childChangedCallback),f.changedCallback&&l.KM.off(g,i,f.changedCallback),f.arrayChangedCallback&&l.KM.off(l.K1F.getValueOnPath(g,i),"*",f.arrayChangedCallback));l.KM.off(g,i,e);l.KM.KQ(g,c)}else l.KM.off(g,i,e)}}})(window);(function(j){function l(e){i[e]=Array.prototype[e];Array.prototype[e]=function(){var d=this.length,c=i[e].apply(this,arguments);this.__knot_attachedData&&(g.KM.notifyDataChanged(this,"*"),d!==this.length&&g.KM.notifyDataChanged(this,"length",d,this.length));return c}}var g=j.Knot.K1M(),i={};l("sort");l("reverse");Array.prototype.notifyChanged=function(e,d){if(this.__knot_attachedData){var c=null;e&&d&&(c={removed:e,added:d});g.KM.notifyDataChanged(this,"*",
c);g.KM.notifyDataChanged(this,"length",null,this.length,{property:"length"})}};i.push=Array.prototype.push;Array.prototype.push=function(){var e=this.length,d=i.push.apply(this,arguments);if(this.__knot_attachedData){for(var c=[],f=0;f<arguments.length;f++)c.push(e+f);this.__knot_arrayVersion?this.__knot_arrayVersion++:this.__knot_arrayVersion=1;g.KM.notifyDataChanged(this,"*",null,null,{removed:[],added:c});g.KM.notifyDataChanged(this,"length",e,this.length,{property:"length"})}return d};
i.unshift=Array.prototype.unshift;Array.prototype.unshift=function(){var e=this.length,d=i.unshift.apply(this,arguments);if(this.__knot_attachedData){for(var c=[],f=0;f<arguments.length;f++)c.push(f);this.__knot_arrayVersion?this.__knot_arrayVersion++:this.__knot_arrayVersion=1;g.KM.notifyDataChanged(this,"*",null,null,{removed:[],added:c});g.KM.notifyDataChanged(this,"length",e,this.length,{property:"length"})}return d};i.pop=Array.prototype.pop;Array.prototype.pop=function(){var e=
this.length,d=i.pop.apply(this,arguments);this.__knot_attachedData&&(this.__knot_arrayVersion?this.__knot_arrayVersion++:this.__knot_arrayVersion=1,g.KM.notifyDataChanged(this,"*",null,null,{removed:[e-1],added:[]}),g.KM.notifyDataChanged(this,"length",e,this.length,{property:"length"}));return d};i.shift=Array.prototype.shift;Array.prototype.shift=function(){var e=this.length,d=i.shift.apply(this,arguments);this.__knot_attachedData&&(this.__knot_arrayVersion?this.__knot_arrayVersion++:
this.__knot_arrayVersion=1,g.KM.notifyDataChanged(this,"*",null,null,{removed:[0],added:[]}),g.KM.notifyDataChanged(this,"length",e,this.length,{property:"length"}));return d};i.splice=Array.prototype.splice;Array.prototype.splice=function(e,d){var c=this.length,f=i.splice.apply(this,arguments);if(this.__knot_attachedData){for(var a=[],b=[],h=e;h<e+d;h++)b.push(h);for(h=e;h<e+arguments.length-2;h++)a.push(h);this.__knot_arrayVersion?this.__knot_arrayVersion++:this.__knot_arrayVersion=
1;g.KM.notifyDataChanged(this,"*",null,null,{removed:b,added:a});g.KM.notifyDataChanged(this,"length",c,this.length,{property:"length"})}return f}})(window);(function(j){var l=j.Knot.K1M(),g=0,i={};l.KS={KT:function(e,d){i[e]?l.Log.error("The global symbol'"+e+"' has been registered."):i[e]=d},KU:function(e){var d="s"+g++;i[d]=e;return"__knot_global."+d},KV:function(e){var e=e.split("."),d=j;"__knot_global"===e[0]&&(d=i,e.splice(0,1));for(var c=0;c<e.length;c++){if(null===d||"undefined"===typeof d)return;d=d[e[c]]}return d},KW:function(e){return l.K1F.K1G(e,"__knot_global.")}}})(window);(function(j){function l(e){e="(function (value) {"+e+"})";try{return i.KS.KU(eval(e))}catch(d){i.Log.error("Invalid pipe function: \r\n"+e,d)}}var g=[{splitter:":",left:!1,right:!1},{splitter:"=>",left:!0,right:!1},{splitter:"<=",left:!1,right:!0},{splitter:"=",left:!0,right:!0}],i=j.Knot.K1M();i.K18={parse:function(e){for(var d=[],e=this.K1E(e),e=i.K1F.K1K(e,";"),c=0;c<e.length;c++){var f=this.K1C(e[c]);
f&&d.push(f)}return d},K1E:function(e){for(var d=i.K1F.K1J(e,0,"{","}");d;)var c=e.substr(d.start+1,d.end-d.start-1),c=l(c),e=e.substr(0,d.start)+c+e.substr(d.end+1),d=i.K1F.K1J(e,0,"{","}");return e},K1C:function(e){e=i.K1F.trim(e);if(!e)return null;for(var d,c,f=0;f<g.length;f++)if(d=i.K1F.K1K(e,g[f].splitter),2===d.length){c=g[f];break}if(!c)return i.Log.error("Invalid option:"+e),null;f=this.K1B(d[0]);d=
this.K1B(d[1]);if(null===f||null===d||f.isComposite&&d.isComposite)return i.Log.error("Invalid option:"+e),null;c.left&&(f.options||(f.options={}),f.options.readonly="1");c.right&&(d.options||(d.options={}),d.options.readonly="1");return{leftAP:f,rightAP:d}},K1B:function(e){e=i.K1F.trim(e);if("("===e[0])return this.K19(e);var d=i.K1F.K1K(e,">"),e=i.K1F.trim(d[0]);d.splice(0,1);var d=d.map(function(a){return i.K1F.trim(a)}),c=null;
if("]"===e[e.length-1]){var f=i.K1F.K1J(e,0,"[","]");f&&(c=this.K1A(e.substr(f.start+1,f.end-f.start-1)),e=e.substr(0,f.start))}return{description:e,pipes:d,options:c}},K1A:function(e){for(var d={},e=i.K1F.K1K(e,";"),c=0;c<e.length;c++){var f=e[c].split(":");2!==f.length||!f[0]||!f[1]?i.Log.error("Invalid AP option:"+e[c]):d[i.K1F.trim(f[0])]=i.K1F.trim(f[1])}return d},K19:function(e){var d=i.K1F.K1J(e,0,"(",")");
if(!d)return i.Log.error("Invalid composite option:"+e),null;for(var c=i.K1F.K1K(e.substr(d.start+1,d.end-d.start-1),"&"),f=[],a=0;a<c.length;a++){var b=this.K1B(c[a]);if(!b)return null;f.push(b)}for(d=d.end+1;">"!==e[d];){if(" "!==e[d]&&"\t"!==e[d]&&"\n"!==e[d])return i.Log.error("Invalid composite option:"+e),null;d++}d++;d=i.K1F.trim(e.substr(d));if(!d)return i.Log.error("Invalid composite option:"+e),null;e=d.split(">").map(function(a){return i.K1F.trim(a)});
return{isComposite:!0,childrenAPs:f,nToOnePipes:e}}}})(window);(function(j){function l(a,b,h,k){if(b&&b[h]){var c=e.K1F.getValueOnPath(null,b[h]);if(!c||"function"!==typeof c)e.Log.error("'"+b[h]+"' must be a function.");else try{c.apply(a,k)}catch(d){e.Log.error("Call AP event handler '"+b[h]+"' failed.",d)}}}function g(a,b,h,k){if(h.description&&("*"===h.description[0]||"!"===h.description[0])){var c=h.description,d=!1;if("!"===c[0]&&(c=e.K1F.trim(c.substr(1)),d=!0,"*"!==c[0]))return{target:k?a:b,ap:h};var f;e.K1F.K1G(c,"*LEFT")&&(f=c.substr(5),
k=!0);e.K1F.K1G(c,"*RIGHT")&&(f=c.substr(6),k=!1);""===f&&(f="*");f&&"."===f[0]&&(f=f.substr(1));if(f){d&&(f="!"+f);var c={},g;for(g in h)h.hasOwnProperty(g)&&(c[g]=h[g]);c.description=f;h=c}}return{target:k?a:b,ap:h}}function i(a){return a.options&&a.options.readonly?(a=a.options.readonly.toLowerCase(),"1"===a||"true"===a):!1}var e=j.Knot.K1M(),d=[],c=[],f=[];e.K3={K4:function(a,b){if(b&&"!"===b[0])return this.K5(a,b)||e.K2;for(var h=
d.length-1;0<=h;h--)if(d[h].doesSupport(a,b))return d[h];return e.K2},K5:function(a,b){for(var h=c.length-1;0<=h;h--)if(c[h].doesSupport(a,b))return c[h];return null},registerAPProvider:function(a,b,h){if(b)0>c.indexOf(a)&&c.push(a);else{0>d.indexOf(a)&&d.push(a);h&&f.push(a);for(a=0;a<f.length;a++)d.splice(d.indexOf(f[a]),1),d.push(f[a])}},unregisterAPProvider:function(a,b){b?0<=c.indexOf(a)&&c.splice(d.indexOf(a),1):(0<=d.indexOf(a)&&d.splice(d.indexOf(a),1),f.indexOf(a)&&
f.splice(f.indexOf(a),1))},K8:{},K9:function(a,b){this.KD(a,b);var h=b.provider.getValue(a,b.description,b.options);try{if(b.pipes){for(var k=0;k<b.pipes.length;k++){var c=e.K1F.getValueOnPath(a,b.pipes[k]);"function"!==typeof c&&e.Log.error("Pipe must be a function. pipe name:"+b.pipes[k]);h=c.apply(a,[h])}b.errorAPProvider&&b.errorAPProvider.setValue(a,"!"+b.description,void 0,b.options);e.Debugger.errorStatusChanged(a,b,void 0)}}catch(d){return b.errorAPProvider&&
(b.errorAPProvider.setValue(a,"!"+b.description,d,b.options),e.Debugger.errorStatusChanged(a,b,d)),this.K8}return h},KA:function(a,b,h,k){if(!b.KB){b.KB=!0;try{this.KD(a,b),b.provider.setValue(a,b.description,h,b.options,k),l(a,b.options,"@set",[b.description,h])}finally{delete b.KB}}},KC:function(a,b,h,k,c){e.Debugger.knotChanged(a,b,h,k,c)},KD:function(a,b){b.provider||(b.provider=this.K4(a,
b.description),b.errorAPProvider=this.K5(a,b.description))},monitor:function(a,b,h,k,c){this.KD(a,b);this.KD(h,k);b.provider.doesSupportMonitoring(a,b.description)&&(b.changedCallback=function(d,f,g,i){if(!k.KB){var n=e.K3.K9(a,b);if(n!==e.K3.K8){c.leftAP===b?e.K3.KC(a,h,c,n,!0):e.K3.KC(h,a,c,n,!1);b.KB=!0;try{e.K3.KA(h,
k,n,i)}finally{delete b.KB}l(a,b.options,"@change",arguments)}}},b.provider.monitor(a,b.description,b.changedCallback,b.options))},stopMonitoring:function(a,b){this.KD(a,b);b.changedCallback&&b.provider.doesSupportMonitoring(a,b.description)&&(b.provider.stopMonitoring(a,b.description,b.changedCallback,b.options),delete b.changedCallback)},KE:function(a,b,h,k,c){var d,f,g,i;a.isComposite?(d=a,f=b,g=h,i=k):(d=h,f=k,g=a,i=b);for(a=0;a<d.childrenAPs.length;a++)d.childrenAPs[a].provider=
e.K3.K4(f,d.childrenAPs[a].description);i.provider=e.K3.K4(i,g.description);d.changedCallback=function(a,h,j,u){a=[];for(h=0;h<d.childrenAPs.length;h++){j=e.K3.K9(f,d.childrenAPs[h]);if(j===e.K3.K8)return;a.push(j)}j=a;if(d.nToOnePipes)for(h=0;h<d.nToOnePipes.length;h++){a=e.K1F.getValueOnPath(f,d.nToOnePipes[h]);typeof a!=="function"&&e.Log.error("Pipe must be a function. pipe name:"+d.nToOnePipes[h]);j=
a.apply(f,[j])}e.K3.KC(b,k,c,j,i===k);e.K3.KA(i,g,j,u);l(i,g,"@change",[b,k,c])};for(a=0;a<d.childrenAPs.length;a++)d.childrenAPs[a].provider.doesSupportMonitoring(f,d.childrenAPs[a].description)&&d.childrenAPs[a].provider.monitor(f,d.childrenAPs[a].description,d.changedCallback,d.childrenAPs[a].options);d.changedCallback()},KF:function(a,b,h){var k=g(a,b,h.leftAP,!0),c=g(a,b,h.rightAP,!1),a=k.target,b=c.target,k=k.ap,c=c.ap;if(k.isComposite||c.isComposite)this.KE(k,
a,c,b,h);else{this.KD(a,k);this.KD(b,c);var d;!i(k)||i(k)&&i(c)?(d=this.K9(b,c),d!==this.K8&&(this.KC(a,b,h,d,!1),this.KA(a,k,d))):(d=this.K9(a,k),d!==this.K8&&(this.KC(b,a,h,d,!1),this.KA(b,c,d)));i(c)||this.monitor(a,k,b,c,h);i(k)||this.monitor(b,c,a,k,h)}e.Debugger.knotTied(a,b,h)},KG:function(a,b,h){var k=g(a,b,h.leftAP,!0),c=g(a,b,h.rightAP,!1),
a=k.target,b=c.target,k=k.ap,c=c.ap;if(k.isComposite||c.isComposite){if(k.isComposite?(c=k,k=a):k=b,c.changedCallback)for(var d=0;d<c.childrenAPs.length;d++)c.childrenAPs[d].provider.doesSupportMonitoring(k,c.childrenAPs[d].description)&&c.childrenAPs[d].provider.stopMonitoring(k,c.childrenAPs[d].description,c.changedCallback,c.childrenAPs[d].options)}else this.stopMonitoring(a,k),delete k.changedCallback,this.stopMonitoring(b,c);delete c.changedCallback;e.Debugger.knotUntied(a,b,h)},KH:function(a){a.changedCallback&&
a.changedCallback()}};e.K2={doesSupport:function(){return!0},getValue:function(a,b){"@"===b[0]&&(b=b.substr(1));return e.K1F.getValueOnPath(a,b)},setValue:function(a,b,h){e.K1F.setValueOnPath(a,b,h)},doesSupportMonitoring:function(a){return"object"!==typeof a?!1:!0},monitor:function(a,b,h){b&&"/"===b[0]&&(a=j,b=b.substr(1));b&&"$"===b[0]&&(a=e.KnotVariants,b=b.substr(1));a&&e.KM.monitor(a,b,h)},stopMonitoring:function(a,b,h){b&&"/"===b[0]&&(a=j,b=b.substr(1));b&&"$"===
b[0]&&(a=e.KnotVariants,b=b.substr(1));a&&e.KM.stopMonitoring(a,b,h)}}})(window);(function(j){function l(a,b,h){for(var c=0,d=k.K1F.K1J(b,c,"{","}");null!==d;){c=b.substr(c,d.start-c);c=k.K1F.trim(c);h&&(c=c.split(",").filter(function(a){return a}).map(function(a){a=k.K1F.trim(a);return h.split(",").filter(function(a){return a}).map(function(b){return k.K1F.trim(b)+" "+a}).join(",")}).join(","));a[c]||(a[c]=[]);for(var e=b.substr(d.start+1,d.end-d.start-1),e=k.K1F.K1K(e,";"),f=0;f<e.length;f++){var g=k.K1F.trim(e[f]);g&&(0===g.indexOf("->")?
l(a,g.substr(2),c):(g=k.K18.K1E(g),0>a[c].indexOf(g)&&a[c].push(g)))}0===a[c].length&&delete a[c];c=d.end+1;d=k.K1F.K1J(b,c,"{","}")}}function g(a){var b=null;a.__knot&&a.__knot.cbsOptions&&(b=a.__knot.cbsOptions,delete a.__knot.cbsOptions);if(a.attributes.binding&&a.attributes.binding.value){b||(b=[]);var h=a.attributes.binding.value,h=k.K18.K1E(h),h=h.split(";").map(function(a){return k.K1F.trim(a)}),b=b.concat(h)}if(b)for(h=
0;h<b.length;h++){a.__knot||(a.__knot={options:[]});var c=k.K18.parse(b[h]);0!==c.length&&(a.__knot.options.push(c[0]),d(c[0].leftAP)&&0>m.indexOf(a)&&m.push(a))}if(a.children)for(b=0;b<a.children.length;b++)g(a.children[b])}function i(a){for(var b=0;b<a.length;b++){var h=a[b].scope,c=a[b].CBS,d=void 0,e=void 0;for(e in c)if(k.K1F.K1G(e,"/")){for(var d=e,f=c,i=[],l=0;l<f[d].length;l++)i=i.concat(k.K18.parse(f[d][l]));k.Kh.addGlobalObjectOption(d,i)}else{var m;
try{m=h.querySelectorAll(e)}catch(j){k.Log.warning("Invalid selector:"+e,j);continue}0===m.length&&k.Log.warning("There is no element selected with selector:"+e);for(d=0;d<m.length;d++)f=c[e].slice(0),m[d].__knot||(m[d].__knot={options:[]}),m[d].__knot.cbsOptions&&(f=m[d].__knot.cbsOptions.concat(f)),m[d].__knot.cbsOptions=f}a[b].scope===document?g(document.body):g(a[b].scope)}}function e(a,b){var h=[],c;b||(c={scope:document,CBS:{},isGlobalScope:!0},h.push(c));for(var d=0;d<a.length;d++){var e;var f=
a[d];if(!f||""===f)e=null;else{for(var g=void 0;0<=(g=f.indexOf("/*"));){e=f.indexOf("*/",g);if(0>e)throw Error("Can't find close mark for comment.");f=f.substr(0,g)+f.substr(e+2)}f=f.split("\n");g="";for(e=0;e<f.length;e++)for(var i=f[e].split("\r"),m=0;m<i.length;m++)"//"!==k.K1F.trim(i[m]).substr(0,2)&&(g+=i[m]);e=g}e=k.K1F.trim(e);if(k.K1F.K1G(e,"$private")){f={CBS:{}};e=e.substr(8);g=f;g.HTML||(g.HTML="");for(var i=0,m="",j=k.K1F.K1J(e,i,"<<{{","}}>>");null!==
j;)m+=e.substr(i,j.start-i),g.HTML+=e.substr(j.start+4,j.end-j.start-4),i=j.end+4,j=k.K1F.K1J(e,i,"<<{{","}}>>");i<e.length&&(m+=e.substr(i));e=m;try{f.scope=document.createElement("DIV"),f.scope.innerHTML=f.HTML,delete f.HTML}catch(r){k.Log.error("Load private scope HTML error.",r);continue}l(f.CBS,e);h.push(f)}else b?k.Log.error("Can't load CBS. It must be a private CBS!"):l(c.CBS,e)}return h}function d(a){return"foreach"===a.description||"content"===a.description}function c(a){for(var a=
a.querySelectorAll("*[knot-template], *[knot-template-id]"),b=0;b<a.length;b++){var h;h=a[b].getAttribute("knot-template-id")?a[b].getAttribute("knot-template-id"):"__knot_template_"+r++;k.Kh.Kk[h]=a[b];a[b].__knot_template_id=h}return Array.prototype.slice.apply(a,[0])}function f(a,b){var h;if(!b.options||!b.options.template&&!b.options.templateSelector){if(h=a.children[0],1<a.children.length&&k.Log.warning("More than one child is found within '"+k.KX.KY(a)+
'", only the first will be taken as template and the reset will be removed.'),!h){k.Log.error("Can't find template within '"+k.KX.KY(a)+"'");return}}else{if(b.options.templateSelector)return;var c=b.options.template;if("@"===c[0])return;h=k.Kh.Kk[c];if(!h){k.Log.error("Can't find template with selector'"+c+"'");return}}h.__knot_template_id||k.Log.error("The template node must be marked with 'knot-template'. Current node:'"+k.KX.KY(a)+
"'");b.options||(b.options={});b.options.template=h.__knot_template_id}function a(a){var b=[],h;for(h=0;h<a.length;h++)b=b.concat(c(a[h].scope));for(h=0;h<m.length;h++)for(var e=0;e<m[h].__knot.options.length;e++)d(m[h].__knot.options[e].leftAP)&&f(m[h],m[h].__knot.options[e].leftAP),d(m[h].__knot.options[e].rightAP)&&f(m[h],m[h].__knot.options[e].rightAP);for(h=m.length=0;h<b.length;h++)delete b[h].__knot_template_id,b[h].removeAttribute("knot-template"),b[h].removeAttribute("knot-template-id"),
b[h].parentNode.removeChild(b[h]);for(h=0;h<a.length;h++)a[h].isGlobalScope||0<a[h].scope.children.length&&k.Log.warning("Useless HTML is detected in private scope.")}function b(a){s.push(a);var b=new k.Deferred,h=k.K1F.K1I();h.onreadystatechange=function(){4===h.readyState&&(200===h.status?b.resolve(h.responseText):b.reject(Error("Load CBS script error. url:"+a+" message:"+h.statusText)))};h.open("GET",a,!0);h.send();return b}function h(){for(var a=new k.Deferred,h=j.document.querySelectorAll('script[type="text/cbs"]'),
c=[],d=0,e=function(){if(0===d)try{a.resolve(c)}catch(h){k.Log.error("Initialize failed.  message:"+h.message,h)}},f=0;f<h.length;f++)h[f].src?0<=s.indexOf(h[f].src)||(d++,function(){var a=h[f].src;b(a).done(function(a){c.push(a);d--;e()},function(h){d--;k.Log.error("Load CBS script error. url:"+a,h);e(h)})}()):c.push(h[f].textContent);0===d&&a.resolve(c);return a}var k=j.Knot.K1M(),m=[],r=0,s=[];k.K1Q={loadGlobalScope:function(){var b=new k.Deferred;h().done(function(h){try{var c=
e(h,!1);i(c);a(c);b.resolve()}catch(d){k.Log.error("Initialize failed.  message:"+d.message,d),b.reject(d)}},function(a){b.reject(a)});return b},loadCBSPackage:function(h){var c=new k.Deferred;0<=s.indexOf(h)?c.resolve():b(h).done(function(b){try{var d=e([b],!0);i(d);a(d)}catch(f){k.Log.error("Parse CBS package failed. package file:"+h,f),c.reject(f)}c.resolve()},function(a){c.reject(a)});return c},test:{parseCBSInDocument:h,getScopes:e,Ks:i,Kv:a}}})(window);(function(j){function l(h){a.Kh.K15(h);h.parentNode.removeChild(h);a.Debugger.nodeRemoved(h)}function g(a,b,c){for(;c<a.children.length;c++)if(a.children[c].__knot&&a.children[c].__knot.dataContext===b)return a.children[c];return null}function i(a,b,c){a.children.length===c?a.appendChild(b):a.insertBefore(b,a.children[c])}function e(b,c,d,e){try{var f=a.K1F.getValueOnPath(d,b);if(!f)return a.Log.error("Can't find template selector:"+b),null;var g=f.apply(c,[d,c]);!g&&!e&&
a.Log.error("The template selector returns NULL. template selector:"+b);return g}catch(i){return a.Log.error("Call template selector failed. template selector:"+b,i),null}}function d(b,c,d){if(!d||!d.template&&!d.templateSelector)a.Log.error("No valid template is specified for 'content' access point. current node:"+a.KX.KY(b));else{var f=function(e,f){if(d&&d[f]){var g=a.K1F.getValueOnPath(b,d[f]);try{g.apply(b,[e,c])}catch(i){a.Log.warning("Raise "+f+" event failed.",
i)}}},g=d.template,i=!1;d.templateSelector&&(null===c||"undefined"===typeof c||(g=e(d.templateSelector,b,c,!0)),i=!0);var j=b.children[0];if(j){if(!(j.__knot&&j.__knot.dataContext===c))if(null===c||"undefined"===typeof c||null===g||"undefined"===typeof g)f(j,"@removing"),l(j),f(j,"@removed");else if(i||a.Kh.K10(g)?(l(j),j=null,g&&(j=a.Kh.createFromTemplate(g,c,b)),j&&(f(j,"@adding"),b.appendChild(j),a.Kh.hasDataContext(j)||a.Kh.setDataContext(j,
c),a.Debugger.nodeAdded(j),f(j,"@added"))):a.Kh.setDataContext(j,c),j)j.__knot||(j.__knot={}),j.__knot.dataContext=c}else if(!(null===c||"undefined"===typeof c||null===g||"undefined"===typeof g))if(g=a.Kh.createFromTemplate(g,c,b))f(j,"@adding"),b.appendChild(g),a.Kh.hasDataContext(g)||a.Kh.setDataContext(g,c),f(g,"@added"),a.Debugger.nodeAdded(g)}}function c(b,c,d,f,j,p){var o,n;c||(c=[]);var q=function(c,d,e){if(j&&j[e]){var f=a.K1F.getValueOnPath(b,
j[e]);try{f.apply(b,[c,d])}catch(k){a.Log.warning("Raise "+e+" event failed.",k)}}};if(p){if(b.__knot_latestForeachArrayVersion!==c.__knot_arrayVersion){if(p.removed){var t=p.removed;for(o=t.length-1;0<=o;o--)n=b.children[t[o]],q(n,null,"@removing"),l(n),q(n,null,"@removed")}if(p.added){p=p.added;for(o=0;o<p.length;o++){if(f&&(d=e(f,b,c[p[o]]),!d))continue;if(n=a.Kh.createFromTemplate(d,c[p[o]],b))q(n,c[p[o]],"@adding"),i(b,n,p[o]),a.Kh.hasDataContext(n)||a.Kh.setDataContext(n,
c[p[o]]),a.Debugger.nodeAdded(n),q(n,c[p[o]],"@added")}}b.__knot_latestForeachArrayVersion=c.__knot_arrayVersion}}else{for(o=0;o<c.length;o++)if(n=g(b,c[o],o))Array.prototype.indexOf.call(b.children,n)!==o&&(b.removeChild(n),i(b,n,o));else{if(f&&(d=e(f,b,c[o]),!d))continue;if(n=a.Kh.createFromTemplate(d,c[o],b))q(n,c[o],"@adding"),i(b,n,o),a.Kh.hasDataContext(n)||a.Kh.setDataContext(n,c[o]),a.Debugger.nodeAdded(n),q(n,c[o],"@added")}for(o=b.children.length-1;o>=
c.length;o--)n=b.children[o],q(n,null,"@removing"),l(n),q(n,null,"@removed")}}function f(b,d,e,f){!e||!e.template&&!e.templateSelector?a.Log.error("No valid template is specified for 'foreach' access point. current node:"+a.KX.KY(b)):c(b,d,e.template,e.templateSelector,e,f)}var a=j.Knot.K1M(),b=[];b["input.value"]="change";b["textarea.value"]="change";b["input.checked"]="change";b["select.selectedIndex"]="change";b["select.value"]="change";b["*.clientWith"]="resize";
b["*.clientHeight"]="resize";b["*.scrollTop"]="scroll";b["*.scrollLeft"]="scroll";a.KX={KY:function(a){var b=a.tagName;a.id?b+="[#"+a.id+"]":a.className&&(b+="["+a.className.split(" ").filter(function(a){return a.trim()!==""}).map(function(a){return"."+a}).join(" ")+"]");return b},getSelectorFromAPDescription:function(b){b=a.K1F.K1K(b,".");return a.K1F.trim(b[0])},getPropertyNameFromAPDescription:function(b){b=a.K1F.K1K(b,".");
if(1<b.length)return b.slice(1).join(".")},getPropertyFromElement:function(b,c){return!b?void 0:a.K1F.getValueOnPath(b,c)},Kd:function(b){if(0<b.indexOf("(")){var c=a.K1F.K1J(b,0,"(",")");if(c)try{var d=b.substr(c.start+1,c.end-c.start-1);return document.querySelector(d)}catch(e){a.Log.error("Query selector failed.",e)}else a.Log.error("Unknown selector:"+b)}else return document.querySelector(b)}};a.Kf={doesSupport:function(a,b){return"#"===b[0]?!0:"!"===b[0]?
!1:a instanceof HTMLElement},getValue:function(b,c){if("@"!==c[0]&&("#"===c[0]&&(b=a.KX.Kd(a.KX.getSelectorFromAPDescription(c)),c=a.KX.getPropertyNameFromAPDescription(c)),!a.K1F.K1G(c,"content")&&!a.K1F.K1G(c,"foreach")))return a.KX.getPropertyFromElement(b,c)},setValue:function(b,c,e,g,i){"@"===c[0]?"function"!==typeof e?a.Log.error("Event listener must be a function!"):b&&b.addEventListener(c.substr(1),function(a){e.apply(b.__knot.dataContext,
[a,b])}):("#"===c[0]&&(b=a.KX.Kd(a.KX.getSelectorFromAPDescription(c)),c=a.KX.getPropertyNameFromAPDescription(c)),a.K1F.K1G(c,"content"))?d(b,e,g):a.K1F.K1G(c,"foreach")?f(b,e,g,i):("undefined"===typeof e&&(e=""),a.K1F.setValueOnPath(b,c,e))},doesSupportMonitoring:function(c,d){"#"===d[0]&&(c=a.KX.Kd(a.KX.getSelectorFromAPDescription(d)),d=a.KX.getPropertyNameFromAPDescription(d));if(!c)return!1;
var e=c.tagName.toLowerCase()+"."+d;return b[e]||b["*."+d]},monitor:function(c,d,e,f){"#"===d[0]&&(c=a.KX.Kd(a.KX.getSelectorFromAPDescription(d)),d=a.KX.getPropertyNameFromAPDescription(d));for(var d=c.tagName.toLowerCase()+"."+d,d=b[d].split(","),g=0;g<d.length;g++)c.addEventListener(d[g],e);("input"===c.tagName.toLowerCase()||"textarea"===c.tagName.toLowerCase())&&(f&&f.immediately&&("1"===f.immediately||"true"===f.immediately.toLowerCase()))&&c.addEventListener("keyup",
e)},stopMonitoring:function(c,d,e,f){"#"===d[0]&&(c=a.KX.Kd(a.KX.getSelectorFromAPDescription(d)),d=a.KX.getPropertyNameFromAPDescription(d));for(var d=c.tagName.toLowerCase()+"."+d,d=b[d].split(","),g=0;g<d.length;g++)c.removeEventListener(d[g],e);("input"===c.tagName.toLowerCase()||"textarea"===c.tagName.toLowerCase())&&(f&&f.immediately&&("1"===f.immediately||"true"===f.immediately.toLowerCase()))&&c.removeEventListener("keyup",e)},syncItems:c};a.K3.registerAPProvider(a.Kf);
a.Kg={doesSupport:function(a,b){return b&&("!"===b[0]&&(b=b.substr(1)),"#"===b[0])?!0:a instanceof HTMLElement},getValue:function(b,c){if("!"===c[0]&&(c=c.substr(1),"#"===c[0]&&(b=a.KX.Kd(a.KX.getSelectorFromAPDescription(c)),c=a.KX.getPropertyNameFromAPDescription(c)),b))return!b.__knot_errorStatusInfo||!b.__knot_errorStatusInfo[c]?null:b.__knot_errorStatusInfo[c].currentStatus},setValue:function(b,c,d,e){if("!"===c[0]&&(c=c.substr(1),"#"===
c[0]&&(b=a.KX.Kd(a.KX.getSelectorFromAPDescription(c)),c=a.KX.getPropertyNameFromAPDescription(c)),b&&(d||b.__knot_errorStatusInfo&&b.__knot_errorStatusInfo[c]&&b.__knot_errorStatusInfo[c].K1O)))if(b.__knot_errorStatusInfo||(b.__knot_errorStatusInfo={}),b.__knot_errorStatusInfo[c]||(b.__knot_errorStatusInfo[c]={}),b.__knot_errorStatusInfo[c].currentStatus!==d){b.__knot_errorStatusInfo[c].currentStatus=d;if(b.__knot_errorStatusInfo[c].K1O)for(var f=
b.__knot_errorStatusInfo[c].K1O,g=0;g<f.length;g++)try{f[g].apply(b,[c,d])}catch(i){a.Log.warning("Call error status changed callback failed.",i)}if(e&&e["@error"])if(f=a.K1F.getValueOnPath(null,e["@error"]),!f||"function"!==typeof f)a.Log.error("'"+e["@error"]+"' must be a function.");else try{f.apply(b,[c,d])}catch(j){a.Log.error("Call AP error event handler '"+e["@error"]+"' failed.",j)}}},doesSupportMonitoring:function(a,b){return"!"===b[0]},monitor:function(b,c,d){if("!"===c[0]){c=
c.substr(1);if("#"===c[0]){var e=a.KX.getSelectorFromAPDescription(c),b=a.KX.Kd(e);if(!b){a.Log.warning("Failed to bind to error status, target is not found.  target selector:"+e);return}c=a.KX.getPropertyNameFromAPDescription(c)}b.__knot_errorStatusInfo||(b.__knot_errorStatusInfo={});b.__knot_errorStatusInfo[c]||(b.__knot_errorStatusInfo[c]={});b.__knot_errorStatusInfo[c].K1O||(b.__knot_errorStatusInfo[c].K1O=[]);b.__knot_errorStatusInfo[c].K1O.push(d)}},
stopMonitoring:function(b,c,d){"#"===c[1]&&(b=a.KX.Kd(a.KX.getSelectorFromAPDescription(c.substr(1))),c=a.KX.getPropertyNameFromAPDescription(c.substr(1)));b.__knot_errorStatusInfo&&(b.__knot_errorStatusInfo[c]&&b.__knot_errorStatusInfo[c].K1O)&&(d=b.__knot_errorStatusInfo[c].K1O.indexOf(d),0<=d&&b.__knot_errorStatusInfo[c].K1O.splice(d,1))},getErrorStatusInformation:function(a,b){if(a.__knot_errorStatusInfo)for(var c in a.__knot_errorStatusInfo)a.__knot_errorStatusInfo[c]&&
a.__knot_errorStatusInfo[c].currentStatus&&b.push({node:a,accessPointName:c,error:a.__knot_errorStatusInfo[c].currentStatus});for(c=0;c<a.children.length;c++)this.getErrorStatusInformation(a.children[c],b)}};a.K3.registerAPProvider(a.Kg,!0)})(window);(function(j){function l(a){if(!a)return null;for(var b=0;b<a.length;b++)if("dataContext"===a[b].leftAP.description)return a[b];return null}function g(a,b){a.__knot?b.__knot=JSON.parse(JSON.stringify(a.__knot)):delete b.__knot;for(var c=0;c<a.children.length;c++)g(a.children[c],b.children[c])}function i(){var a,b;for(b in c){(function(){var e=b;c[e].objectObserveCallback=function(b,f,h){b=c[e].options;if(f)for(a=0;a<b.length;a++)d.K3.KG(f,null,b[a]);for(a=0;a<b.length;a++)d.K3.KF(h,
null,b[a])};d.KM.monitor(j,b.substr(1),c[e].objectObserveCallback)})();var e=d.K1F.getValueOnPath(null,b);if(e){var f=c[b].options;for(a=0;a<f.length;a++)d.K3.KF(e,null,f[a])}}}function e(a,b){a.__knot_component||(f[b]?a.__knot_component=f[b](a,b):d.Log.error("Component '"+b+"' is not registered."))}var d=j.Knot.K1M(),c={},f={};d.Kh={Kk:{},addGlobalObjectOption:function(a,b){c[a]||(c[a]={options:[]});c[a].options=c[a].options.concat(b)},
K10:function(a){return"function"===typeof a||!this.Kk[a]},createFromTemplate:function(a,b,c){if(this.K10(a)){var e,f;f="function"===typeof a?a:d.K1F.getValueOnPath(b,a);"function"===typeof f?e=f.apply(c,[b]):d.Log.error("Unknown template:"+a);return e}d.Kh.Kk[a]?(a=d.Kh.Kk[a],b=a.cloneNode(!0),g(a,b),a=b):(d.Log.error("Failed find template. id:"+a),a=void 0);return a},hasDataContext:function(a){return a.__knot&&"dataContext"in
a.__knot},setDataContext:function(a,b){this.K13(a,b,!0);a.__knot?a.__knot.dataContext=b:a.__knot={dataContext:b};a.__knot.isFixedDataContext=!0},K11:function(a){if(a.__knot&&a.__knot.options)for(var b=0;b<a.__knot.options.length;b++)"dataContext"!==a.__knot.options[b].leftAP.description&&d.K3.KG(a,a.__knot.dataContext,a.__knot.options[b])},K12:function(a){if(a.__knot&&a.__knot.options)for(var b=0;b<a.__knot.options.length;b++)"dataContext"!==a.__knot.options[b].leftAP.description&&
d.K3.KF(a,a.__knot.dataContext,a.__knot.options[b])},K13:function(a,b,c){if(a instanceof HTMLElement||a instanceof HTMLBodyElement){var f;a.getAttribute("knot-component")&&e(a,a.getAttribute("knot-component"));if(a.__knot){if(c||!a.__knot.isFixedDataContext){f=l(a.__knot.options);c=b;if(f){c=d.K3.K9(b,f.rightAP);if(c===d.K3.K8){d.Log.error("Get context data failed. node:"+d.KX.KY(a));return}if(f.hasTiedUpKnot&&
c===a.__knot.dataContext)return;(f.data||"/"===f.rightAP.description[0])&&f.changedCallback&&f.rightAP.provider.stopMonitoring(f.data,f.rightAP.description,f.changedCallback,f.rightAP.options);f.data=b;f.data||"/"===f.rightAP.description[0]?(f.changedCallback=function(){d.Kh.K13(a,b)},f.rightAP.provider.monitor(f.data,f.rightAP.description,f.changedCallback,f.rightAP.options)):f.changedCallback=null;f.hasTiedUpKnot=!0}this.K11(a);d.K3.KC(a,
b,f,c,!1);for(f=0;f<a.children.length;f++)this.K13(a.children[f],c);a.__knot.dataContext=c;this.K12(a)}}else for(f=0;f<a.children.length;f++)this.K13(a.children[f],b)}},K14:function(a){for(;a;){if(a.__knot)return a.__knot.dataContext;a=a.parentNode}},K15:function(a){if(a.__knot){var b=l(a.__knot.options);b&&((b.data||"/"===b.rightAP.description[0])&&b.changedCallback&&b.rightAP.provider.stopMonitoring(b.data,b.rightAP.description,b.changedCallback,
b.rightAP.options),b.data=null,b.changedCallback=null,b.hasTiedUpKnot=!1);this.K11(a);delete a.__knot.dataContext}a.__knot_component&&(a.__knot_component.dispose&&a.__knot_component.dispose(),delete a.__knot_component);for(b=0;b<a.children.length;b++)this.K15(a.children[b])},bind:function(){i();this.K13(document.body,null)},clear:function(a){if(!a){var b,e;for(e in c){c[e].objectObserveCallback&&d.KM.stopMonitoring(j,e.substr(1),c[e].objectObserveCallback);
var f=d.K1F.getValueOnPath(null,e);if(f){var g=c[e].options;for(b=0;b<g.length;b++)d.K3.KG(f,null,g[b])}}}this.K15(a||document.body)},K16:function(a,b){a.__knot||(a.__knot={});a.__knot.dataContext=b},K1L:function(a){if(a.__knot)return a.__knot.dataContext},K17:function(a){var b;if(a.__knot&&a.__knot.options)for(b=0;b<a.__knot.options.length;b++)"dataContext"!==a.__knot.options[b].leftAP.description&&!(a.__knot.options[b].leftAP.description&&
"!"===a.__knot.options[b].leftAP.description[0])&&d.K3.KH(a.__knot.options[b].leftAP);for(b=0;b<a.children.length;b++)this.K17(a.children[b])},registerComponent:function(a,b){if(f[a])throw Error("Component '"+a+"' has been registered!");f[a]=b},getComponentObject:function(a){return a.__knot_component}}})(window);(function(j){function l(c,d,a,b){b=e.K18.parse(d+":"+b);0<b.length?(e.K3.KF(c,a,b[0]),c.__knot.options||(c.__knot.options=[]),c.__knot.options.push(b[0])):c[d]=a;return b}function g(c){var d=c.tagName.toLowerCase();"input"===d&&(d+=c.type.toLocaleLowerCase());return d}function i(c){if(c=c.options[c.selectedIndex])return c.__knot?c.__knot.dataContext:void 0}var e=j.Knot.K1M(),d={text:{"input.text":"value",textarea:"value",option:"text",span:"textContent","*":"textContent"}};
e.K3.registerAPProvider({doesSupport:function(c,f){"#"===f[0]&&(c=e.KX.Kd(e.KX.getSelectorFromAPDescription(f)),f=e.KX.getPropertyNameFromAPDescription(f));return c instanceof HTMLElement&&("select"===c.tagName.toLowerCase()&&(e.K1F.K1G(f,"options")||"selectedData"===f||e.K1F.K1G(f,"selectedData.")||"value"===f)||"class"===f||d[f])?!0:!1},getValue:function(c,f){"#"===f[0]&&(c=e.KX.Kd(e.KX.getSelectorFromAPDescription(f)),
f=e.KX.getPropertyNameFromAPDescription(f));if("select"===c.tagName.toLowerCase()&&("selectedData"===f||e.K1F.K1G(f,"selectedData.")))return"selectedData"===f?i(c):e.K1F.getValueOnPath(i(c),f.split(".").slice(1).join("."));if("select"===c.tagName.toLowerCase()&&"value"===f)return 0<=c.selectedIndex?c.options[c.selectedIndex].value:void 0;if("class"===f)return c.className;if("select"===c.tagName.toLowerCase()&&e.K1F.K1G(f,"options"))return c.options;if(d[f]){var a;
a=c;var b=f,h=g(a);a=d[b][h]?a[d[b][h]]:a[d[b]["*"]];return a}},setValue:function(c,f,a,b){"#"===f[0]&&(c=e.KX.Kd(e.KX.getSelectorFromAPDescription(f)),f=e.KX.getPropertyNameFromAPDescription(f));if("class"===f){if(a){for(var b=[],f=c.className.split(" "),a=a.split(" "),h=0;h<a.length;h++){var k=a[h];"-"===k[0]?(k=k.substr(1).trim(),0<=f.indexOf(k)&&f.splice(f.indexOf(k),1)):"+"===k[0]?(k=k.substr(1).trim(),0>f.indexOf(k)&&f.push(k)):b.push(k)}c.className=0<
b.length?b.join(" "):f.join(" ")}}else if("select"===c.tagName.toLowerCase()&&"value"===f){for(b=0;b<c.options.length;b++)if(c.options[b].value===a){c.selectedIndex=b;return}c.selectedIndex=-1}else if("select"===c.tagName.toLowerCase()&&("selectedData"===f||e.K1F.K1G(f,"selectedData.")))if("selectedData"===f)a:{for(b=0;b<c.options.length;b++)if(c.options[b].__knot&&c.options[b].__knot.dataContext===a){c.selectedIndex=b;break a}c.selectedIndex=-1}else e.K1F.setValueOnPath(i(c),f.split(".").slice(1).join("."));
else if("select"===c.tagName.toLowerCase()&&e.K1F.K1G(f,"options")){(f=b)||(f={});a||(a=[]);for(b=0;b<a.length;b++){a:{for(var h=c.options,k=a[b],j=b;j<h.length;j++)if(e.Kh.K1L(h[j])===k){h=h[j];break a}h=null}h?c.options[b].indexOf(h)!==b&&(c.options.remove(c.options[b].indexOf(h)),c.options.add(h,b)):(h=document.createElement("option"),e.Kh.K16(h,a[b]),a[b]&&(f.displayMember?l(h,"text",a[b],f.displayMember):h.text=a[b],f.valueMember?
l(h,"value",a[b],f.valueMember):h.value=a[b]),c.options.add(h,b))}for(b=c.options.length-1;b>=a.length;b--){f=c.options[b];if(f.__knot&&f.__knot.options){for(h=0;h<f.__knot.options.length;h++)e.K3.KG(f,f.__knot.dataContext,f.__knot.options[h]);delete f.__knot.dataContext}c.options.remove(b)}}else d[f]&&(b=f,"undefined"===typeof a&&(a=""),f=g(c),d[b][f]?c[d[b][f]]=a:c[d[b]["*"]]=a)},doesSupportMonitoring:function(c,d){"#"===d[0]&&(c=e.KX.Kd(e.KX.getSelectorFromAPDescription(d)),
d=e.KX.getPropertyNameFromAPDescription(d));return c&&"select"===c.tagName.toLowerCase()&&("selectedData"===d||e.K1F.K1G(d,"selectedData.")||"value"===d)},monitor:function(c,d,a){"#"===d[0]&&(c=e.KX.Kd(e.KX.getSelectorFromAPDescription(d)),d=e.KX.getPropertyNameFromAPDescription(d));"select"===c.tagName.toLowerCase()&&("selectedData"===d||e.K1F.K1G(d,"selectedData.")||"value"===d)&&c.addEventListener("change",a)},stopMonitoring:function(c,
d,a){"#"===d[0]&&(c=e.KX.Kd(e.KX.getSelectorFromAPDescription(d)),d=e.KX.getPropertyNameFromAPDescription(d));"select"===c.tagName.toLowerCase()&&("selectedData"===d||e.K1F.K1G(d,"selectedData.")||"value"===d)&&c.removeEventListener("change",a)}})})(window);(function(j){j.Knot.K1M().K3.registerAPProvider({doesSupport:function(j){return j&&j.__knot_component},getValue:function(j,g,i){return j.__knot_component.getValue(g,i)},setValue:function(j,g,i,e){j.__knot_component.setValue(g,i,e)},doesSupportMonitoring:function(j,g){return j.__knot_component.doesSupportMonitoring(g)},monitor:function(j,g,i,e){j.__knot_component.monitor(g,i,e)},stopMonitoring:function(j,g,i,e){j.__knot_component.stopMonitoring(g,i,e)}},!1,!0)})(window);(function(j){function l(){if(!c){c=!0;try{if(e){for(var a=e.map(function(a){return i.K1F.getValueOnPath(null,"$hash."+a)}),b=a.length-1;0<=b&&!a[b];b--)a.length=b;b="";0<a.length&&(b=a.join(d));j.location.hash="#"+b;i.K1F.setValueOnPath(null,"$hash.originalHash",b)}}finally{c=!1}}}function g(){if(!c){c=!0;try{var a;a=j.location.hash?j.location.hash.substr(1):"";if(e)for(var b=i.K1F.K1K(a,d),f=0;f<e.length;f++)i.K1F.setValueOnPath(null,"$hash."+e[f],b[f]);i.K1F.setValueOnPath(null,
"$hash.originalHash",a)}finally{c=!1}}}var i=j.Knot.K1M(),e,d,c=!1;i.K1F.setValueOnPath(null,"$hash",{});var f=i.K1F.getValueOnPath(null,"$hash");g();i.K1P={setHashFormat:function(a,b){if(!(a instanceof Array))throw Error("Hash fields must be an array.");if(0<=a.indexOf("hash"))throw Error("Hash field can't be 'hash'.");if(!b)throw Error("Please specify the splitter.");var c;if(e)for(c=0;c<e.length;c++)i.KM.stopMonitoring(f,e[c],l);e=a;d=b;if(e)for(c=0;c<
e.length;c++)i.KM.monitor(f,e[c],l);g()}};i.KM.monitor(f,"originalHash",function(){j.location.hash="#"+f.originalHash;g()});j.addEventListener("hashchange",function(){g()})})(window);(function(j){function l(){var d;for(d=0;d<i.length;d++)try{if(e)i[d](!1,e);else i[d](!0)}catch(c){g.Log.warning("Execute on ready callback failed.",c)}i.length=0}var g=j.Knot.K1M();delete j.Knot.K1M;j.Knot.Advanced={registerAPProvider:function(d){return g.K3.registerAPProvider(d)},registerLogger:function(d){g.Log.log=d},registerDebugger:function(d){g.Debugger=d},synchronizeItems:function(d,c,e){g.Kf.syncItems(d,c,e)},createFromTemplate:function(d,c,e){return g.Kh.createFromTemplate(d,
c,e)},setDataContext:function(d,c){g.Kh.setDataContext(d,c)},getValueOnPath:function(d,c){return g.K1F.getValueOnPath(d,c)},registerNamedGlobalSymbol:function(d,c){return g.KS.KT(d,c)},registerComponent:function(d,c){return g.Kh.registerComponent(d,c)},getComponentObject:function(d){return g.Kh.getComponentObject(d)}};j.Knot.getErrorStatusInformation=function(d){d||(d=document.body);g.Kh.K17(d);
var c=[];g.Kg.getErrorStatusInformation(d,c);return c};j.Knot.notifyObjectChanged=function(d,c,e,a,b){g.KM.notifyDataChanged(d,c,e,a,b)};j.Knot.monitorObject=function(d,c,e){g.KM.monitorObject(d,c,e)};j.Knot.stopMonitoringObject=function(d,c,e){g.KM.stopMonitoring(d,c,e)};j.Knot.getPropertiesChangeRecords=function(d){return g.KM.getPropertiesChangeRecords(d)};j.Knot.clearPropertiesChangeRecords=function(d){return g.KM.clearPropertiesChangeRecords(d)};
j.Knot.clear=function(d){g.Kh.clear(d)};j.Knot.getDataContext=function(d){return g.Kh.K14(d)};j.Knot.findElementBindToData=function(d,c){for(var e=0;e<d.length;e++)if(j.Knot.getDataContext(d[e])===c)return d};j.Knot.setHashFormat=function(d,c){g.K1P.setHashFormat(d,c)};j.Knot.getKnotVariant=function(d){return g.K1F.getValueOnPath(null,d)};j.Knot.setKnotVariant=function(d,c){return g.K1F.setValueOnPath(null,d,c)};var i=[],e;j.Knot.ready=
function(d){i.push(d);(j.Knot.isReady||e)&&l()};j.Knot.isReady=!1;j.addEventListener("load",function(){g.K1Q.loadGlobalScope().done(function(){g.Kh.bind();j.Knot.isReady=!0;e=null;l()},function(d){j.Knot.isReady=!1;e=d;l()})})})(window);
