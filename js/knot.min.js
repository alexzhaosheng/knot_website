(function(j){var k={KnotVariants:{},Setting:{enablePropertyHook:!0},Log:{Level:{Info:"Info",Warning:"Warning",Error:"Error"},log:function(g,h,f){j.console&&(j.console.log("["+g+"]"+h),f&&j.console.log(f))},info:function(g,h){this.log(this.Level.Info,g,h)},warning:function(g,h){this.log(this.Level.Warning,g,h)},error:function(g,h){this.log(this.Level.Error,g,h)}},Debugger:{knotChanged:function(){},knotTied:function(){},knotUntied:function(){},nodeAdded:function(){},nodeRemoved:function(){},errorStatusChanged:function(){}}};
j.Knot={K1M:function(){return k}}})(window);(function(j){var k=j.Knot.K1M(),g={"(":!0,"{":!0,"[":!0},h={")":!0,"}":!0,"]":!0},f={"(":")","{":"}","[":"]"};k.K1F={K1H:function(e){for(var d in e)return!1;return!0},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},K1G:function(e,d){return!e?!1:e.substr(0,d.length)===d},getValueOnPath:function(e,d){if(!d&&""!==d||"*NULL"===d)return null;if("*"===d||""===d)return e;if("'"===d[0]&&"'"===d[d.length-1])return d.substr(1,d.length-2);var c=!1;"@"===d[0]&&
(c=!0,d=d.substr(1));var a;if(this.K1G(d,"__knot_global"))a=k.KS.KV(d);else{var b=e;"/"===d[0]?(b=j,d=d.substr(1)):"$"===d[0]&&(b=k.KnotVariants,d=d.substr(1));for(;0<=d.indexOf(".")&&b;)var i=k.K1F.trim(d.substr(0,d.indexOf("."))),b="*"!==i?b[i]:void 0,d=k.K1F.trim(d.substr(d.indexOf(".")+1));"*"===d?a=b:b&&(a=b[d])}if(c&&a&&"function"!==typeof a)k.Log.error("'"+d+"' is expected as a function, but it isn't.");else return a},setValueOnPath:function(e,d,c){if("*"!==
d[d.length-1]){if(this.K1G(d,"__knot_global"))throw Error("Can't set global symbol!");d&&"/"===d[0]?(e=j,d=d.substr(1)):"$"===d[0]&&(e=k.KnotVariants,d=d.substr(1));var a=d,b=d.lastIndexOf(".");0<b&&(a=d.substr(b+1),e=this.getValueOnPath(e,d.substr(0,b)));e&&(e[a]=c)}},K1I:function(){return j.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},K1J:function(e,d,c,a){var b={start:-1,end:-1};b.start=e.indexOf(c,d);if(0>b.start)return null;for(var d=0,i=b.start+
1;;){var f=e.indexOf(c,i),i=e.indexOf(a,i);if(0>i)break;if(0>f||i<f){if(0===d){b.end=i;break}else d--;i+=1}else d++,i=f+1}return 0<=b.start&&0<=b.end?b:null},K1K:function(e,d){for(var c=0,a=0,b=[],i=[],l=d.length;c<e.length;){if(g[e[c]])i.push(e[c]);else if(h[e[c]]){var o=i.pop();f[o]!==e[c]&&(k.Log.warning("Unclosed block is detected.\r"+e),i.push(o))}else 0===i.length&&(e[c]===d[0]&&e.substr(c,l)===d)&&(b.push(e.substr(a,c-a)),a=c+l);c++}0<i.length&&k.Log.warning("Unclosed block is detected.\r"+
e);c>=a&&b.push(e.substr(a,c-a));return b}}})(window);(function(j){j=j.Knot.K1M();j.Deferred=function(){this._succCallbacks=[];this._errCallbacks=[];this.isRejected=this.isFinished=!1;this.result=null};j.Deferred.prototype.resolve=function(k){this.result=k;this.isFinished=!0;this.isRejected=!1;for(var g=0;g<this._succCallbacks.length;g++)this._succCallbacks[g](k)};j.Deferred.prototype.reject=function(k){this.result=k;this.isRejected=this.isFinished=!0;for(var g=0;g<this._errCallbacks.length;g++)this._errCallbacks[g](k)};j.Deferred.prototype.done=
function(k,g){this.isFinished?this.isRejected?g(this.result):k(this.result):(this._succCallbacks.push(k),this._errCallbacks.push(g));return this}})(window);(function(j){var k=j.Knot.K1M();k.KJ={_dataInMonitoring:[],_attachedInfoOfData:[],KK:function(g){if(k.Setting.enablePropertyHook){if(!g.__knot_attachedData){if("object"!==typeof g)throw Error("Can only monitor object or array!");Object.defineProperty(g,"__knot_attachedData",{value:{},configurable:!0,writable:!1,enumerable:!1})}return g.__knot_attachedData}0>this._dataInMonitoring.indexOf(g)&&(this._dataInMonitoring.push(g),this._attachedInfoOfData[this._dataInMonitoring.indexOf(g)]=
{});return this._attachedInfoOfData[this._dataInMonitoring.indexOf(g)]},KL:function(g){k.Setting.enablePropertyHook?delete g.__knot_attachedData:(g=this._dataInMonitoring.indexOf(g),0<=g&&(delete this._dataInMonitoring[g],delete this._attachedInfoOfData[g]))}}})(window);(function(j){var k=j.Knot.K1M();k.KM={on:function(g,h,f,e){g=k.KJ.KK(g);g.K1O||(g.K1O={});h||(h="*");g.K1O[h]||(g.K1O[h]=[]);g.K1O[h].push({callback:f,attachedData:e})},off:function(g,h,f){h||(h="*");var e=k.KJ.KK(g);if(e.K1O&&e.K1O[h]){for(var d=0;d<e.K1O[h].length;d++)if(e.K1O[h][d].callback===f){e.K1O[h].splice(d,
1);break}0===e.K1O[h].length&&(delete e.K1O[h],k.K1F.K1H(e)&&k.KJ.KL(g))}},KN:function(g,h,f){g=k.KJ.KK(g);if(g.K1O&&g.K1O[h])for(var e=0;e<g.K1O[h].length;e++)if(g.K1O[h][e].callback===f)return!0;return!1},KO:function(g,h,f){g=k.KJ.KK(g);if(g.K1O&&g.K1O[h])for(var e=0;e<g.K1O[h].length;e++)if(g.K1O[h][e].callback===
f)return g.K1O[h][e].attachedData;return null},notifyDataChanged:function(g,h,f,e,d){var c=k.KJ.KK(g);c.changedProperties||(c.changedProperties=[]);0>c.changedProperties.indexOf(h)&&c.changedProperties.push(h);var a,b;if(c.K1O&&c.K1O[h]){a=c.K1O[h].slice(0);for(b=0;b<a.length;b++)try{a[b].callback.apply(g,[h,f,e,d])}catch(i){k.Log.warning("Call changed callback failed.",i)}}if(c.K1O&&c.K1O["*"]&&"*"!==
h){a=c.K1O["*"].slice(0);for(b=0;b<a.length;b++)try{a[b].callback.apply(g,[h,f,e,d])}catch(l){k.Log.warning("Call changed callback failed.",l)}}},getPropertiesChangeRecords:function(g){g=k.KJ.KK(g);return!g?null:g.changedProperties?g.changedProperties:[]},clearPropertiesChangeRecords:function(g){g=k.KJ.KK(g);if(!g)return null;g.changedProperties=null},KP:function(g,h){if("*"!==h){var f=k.KJ.KK(g);f.dataHookInfo||
(f.dataHookInfo={hookedProperties:[],data:{},hookRefCount:{}});if(0<=f.dataHookInfo.hookedProperties.indexOf(h))f.dataHookInfo.hookRefCount[h]++;else if(f.dataHookInfo.hookedProperties.push(h),f.dataHookInfo.data[h]=g[h],f.dataHookInfo.hookRefCount[h]=1,!(g instanceof Array&&"length"===h))try{Object.defineProperty(g,h,{set:function(d){var c=f.dataHookInfo.data[h];if(c!==d){f.dataHookInfo.data[h]=d;k.KM.notifyDataChanged(this,h,c,d)}},get:function(){return f.dataHookInfo.data[h]},configurable:!0,
enumerable:!0})}catch(e){f.dataHookInfo.hookFailed=!0,k.Log.warning("Hook property failed. property:"+h,e)}}},KQ:function(g,h){if("*"!==h){var f=k.KJ.KK(g);f.dataHookInfo&&(!(0>f.dataHookInfo.hookedProperties.indexOf(h))&&!(0<--f.dataHookInfo.hookRefCount[h]))&&(f.dataHookInfo.hookFailed||(delete g[h],g[h]=f.dataHookInfo.data[h]),f.dataHookInfo.hookedProperties.splice(f.dataHookInfo.hookedProperties.indexOf(h),1),delete f.dataHookInfo.data[h],delete f.dataHookInfo.hookRefCount[h])}},
KR:function(g,h){var f=k.KJ.KK(g);return!f.dataHookInfo?!1:0<=f.dataHookInfo.hookedProperties.indexOf(h)},monitorObject:function(g,h,f,e){var d,c=h.substr(0,h.indexOf("."));c?d=h.substr(h.indexOf(".")+1):(c=h,d=null);var a={};k.KM.on(g,h,f,a);d&&(a.childChangedCallback=function(b,a,e,f){k.KM.notifyDataChanged(g,c+"."+d,a,e,f)},a.monitorChildChangedCallback=function(b,i,e,f){i&&k.KM.stopMonitoring(i,d,a.childChangedCallback);e&&k.KM.monitorObject(e,
d,a.childChangedCallback,true);b=c+"."+d;e=k.K1F.getValueOnPath(e,d);i=k.K1F.getValueOnPath(i,d);k.KM.notifyDataChanged(g,b,i,e,f)},k.KM.on(g,c,a.monitorChildChangedCallback),g[c]&&k.KM.monitorObject(g[c],d,a.childChangedCallback,!0));e||(a.changedCallback=function(b,i,c){if(i instanceof Array){k.KM.off(i,"*",a.arrayChangedCallback);delete a.arrayChangedCallback}if(c instanceof Array){a.arrayChangedCallback=function(b,a,i,c){k.KM.notifyDataChanged(g,
h,i,i,c)};k.KM.on(c,"*",a.arrayChangedCallback)}},k.KM.on(g,h,a.changedCallback,a),f=k.K1F.getValueOnPath(g,h),f instanceof Array&&a.changedCallback("*",null,f));k.KM.KP(g,c)},monitor:function(g,h,f){if(h)"/"===h[0]&&(h=h.substr(1),g=j),this.monitorObject(g,h,f);else k.KM.on(g,null,f)},stopMonitoring:function(g,h,f){if(h){"/"===h[0]&&(h=h.substr(1),g=j);var e,d=h.substr(0,h.indexOf("."));d?e=h.substr(h.indexOf(".")+1):(d=h,e=null);var c=k.KM.KO(g,
h,f);c&&(c.monitorChildChangedCallback&&k.KM.off(g,d,c.monitorChildChangedCallback),c.childChangedCallback&&g[d]&&k.KM.stopMonitoring(g[d],e,c.childChangedCallback),c.changedCallback&&k.KM.off(g,h,c.changedCallback),c.arrayChangedCallback&&k.KM.off(k.K1F.getValueOnPath(g,h),"*",c.arrayChangedCallback));k.KM.off(g,h,f);k.KM.KQ(g,d)}else k.KM.off(g,h,f)}}})(window);(function(j){function k(f){h[f]=Array.prototype[f];Array.prototype[f]=function(){var e=this.length,d=h[f].apply(this,arguments);this.__knot_attachedData&&(g.KM.notifyDataChanged(this,"*"),e!==this.length&&g.KM.notifyDataChanged(this,"length",e,this.length));return d}}var g=j.Knot.K1M(),h={};k("sort");k("reverse");Array.prototype.notifyChanged=function(f,e){if(this.__knot_attachedData){var d=null;f&&e&&(d={removed:f,added:e});g.KM.notifyDataChanged(this,"*",
d);g.KM.notifyDataChanged(this,"length",null,this.length,{property:"length"})}};h.push=Array.prototype.push;Array.prototype.push=function(){var f=this.length,e=h.push.apply(this,arguments);if(this.__knot_attachedData){for(var d=[],c=0;c<arguments.length;c++)d.push(f+c);this.__knot_arrayVersion?this.__knot_arrayVersion++:this.__knot_arrayVersion=1;g.KM.notifyDataChanged(this,"*",null,null,{removed:[],added:d});g.KM.notifyDataChanged(this,"length",f,this.length,{property:"length"})}return e};
h.unshift=Array.prototype.unshift;Array.prototype.unshift=function(){var f=this.length,e=h.unshift.apply(this,arguments);if(this.__knot_attachedData){for(var d=[],c=0;c<arguments.length;c++)d.push(c);this.__knot_arrayVersion?this.__knot_arrayVersion++:this.__knot_arrayVersion=1;g.KM.notifyDataChanged(this,"*",null,null,{removed:[],added:d});g.KM.notifyDataChanged(this,"length",f,this.length,{property:"length"})}return e};h.pop=Array.prototype.pop;Array.prototype.pop=function(){var f=
this.length,e=h.pop.apply(this,arguments);this.__knot_attachedData&&(this.__knot_arrayVersion?this.__knot_arrayVersion++:this.__knot_arrayVersion=1,g.KM.notifyDataChanged(this,"*",null,null,{removed:[f-1],added:[]}),g.KM.notifyDataChanged(this,"length",f,this.length,{property:"length"}));return e};h.shift=Array.prototype.shift;Array.prototype.shift=function(){var f=this.length,e=h.shift.apply(this,arguments);this.__knot_attachedData&&(this.__knot_arrayVersion?this.__knot_arrayVersion++:
this.__knot_arrayVersion=1,g.KM.notifyDataChanged(this,"*",null,null,{removed:[0],added:[]}),g.KM.notifyDataChanged(this,"length",f,this.length,{property:"length"}));return e};h.splice=Array.prototype.splice;Array.prototype.splice=function(f,e){var d=this.length,c=h.splice.apply(this,arguments);if(this.__knot_attachedData){for(var a=[],b=[],i=f;i<f+e;i++)b.push(i);for(i=f;i<f+arguments.length-2;i++)a.push(i);this.__knot_arrayVersion?this.__knot_arrayVersion++:this.__knot_arrayVersion=
1;g.KM.notifyDataChanged(this,"*",null,null,{removed:b,added:a});g.KM.notifyDataChanged(this,"length",d,this.length,{property:"length"})}return c}})(window);(function(j){var k=j.Knot.K1M(),g=0,h={};k.KS={KT:function(f,e){h[f]?k.Log.error("The global symbol'"+f+"' has been registered."):h[f]=e},KU:function(f){var e="s"+g++;h[e]=f;return"__knot_global."+e},KV:function(f){var f=f.split("."),e=j;"__knot_global"===f[0]&&(e=h,f.splice(0,1));for(var d=0;d<f.length;d++){if(null===e||"undefined"===typeof e)return;e=e[f[d]]}return e},KW:function(f){return k.K1F.K1G(f,"__knot_global.")}}})(window);(function(j){function k(f){f="(function (value) {"+f+"})";try{return h.KS.KU(eval(f))}catch(e){h.Log.error("Invalid pipe function: \r\n"+f,e)}}var g=[{splitter:":",left:!1,right:!1},{splitter:"=>",left:!0,right:!1},{splitter:"<=",left:!1,right:!0},{splitter:"=",left:!0,right:!0}],h=j.Knot.K1M();h.K18={parse:function(f){for(var e=[],f=this.K1E(f),f=h.K1F.K1K(f,";"),d=0;d<f.length;d++){var c=this.K1C(f[d]);
c&&e.push(c)}return e},K1E:function(f){for(var e=h.K1F.K1J(f,0,"{","}");e;)var d=f.substr(e.start+1,e.end-e.start-1),d=k(d),f=f.substr(0,e.start)+d+f.substr(e.end+1),e=h.K1F.K1J(f,0,"{","}");return f},K1C:function(f){f=h.K1F.trim(f);if(!f)return null;for(var e,d,c=0;c<g.length;c++)if(e=h.K1F.K1K(f,g[c].splitter),2===e.length){d=g[c];break}if(!d)return h.Log.error("Invalid option:"+f),null;c=this.K1B(e[0]);e=
this.K1B(e[1]);if(null===c||null===e||c.isComposite&&e.isComposite)return h.Log.error("Invalid option:"+f),null;d.left&&(c.options||(c.options={}),c.options.readonly="1");d.right&&(e.options||(e.options={}),e.options.readonly="1");return{leftAP:c,rightAP:e}},K1B:function(f){f=h.K1F.trim(f);if("("===f[0])return this.K19(f);var e=h.K1F.K1K(f,">"),f=h.K1F.trim(e[0]);e.splice(0,1);var e=e.map(function(a){return h.K1F.trim(a)}),d=null;
if("]"===f[f.length-1]){var c=h.K1F.K1J(f,0,"[","]");c&&(d=this.K1A(f.substr(c.start+1,c.end-c.start-1)),f=f.substr(0,c.start))}return{description:f,pipes:e,options:d}},K1A:function(f){for(var e={},f=h.K1F.K1K(f,";"),d=0;d<f.length;d++){var c=f[d].split(":");2!==c.length||!c[0]||!c[1]?h.Log.error("Invalid AP option:"+f[d]):e[h.K1F.trim(c[0])]=h.K1F.trim(c[1])}return e},K19:function(f){var e=h.K1F.K1J(f,0,"(",")");
if(!e)return h.Log.error("Invalid composite option:"+f),null;for(var d=h.K1F.K1K(f.substr(e.start+1,e.end-e.start-1),"&"),c=[],a=0;a<d.length;a++){var b=this.K1B(d[a]);if(!b)return null;c.push(b)}for(e=e.end+1;">"!==f[e];){if(" "!==f[e]&&"\t"!==f[e]&&"\n"!==f[e])return h.Log.error("Invalid composite option:"+f),null;e++}e++;e=h.K1F.trim(f.substr(e));if(!e)return h.Log.error("Invalid composite option:"+f),null;f=e.split(">").map(function(b){return h.K1F.trim(b)});
return{isComposite:!0,childrenAPs:c,nToOnePipes:f}}}})(window);(function(j){function k(a,b,i,c){if(b&&b[i]){var e=f.K1F.getValueOnPath(null,b[i]);if(!e||"function"!==typeof e)f.Log.error("'"+b[i]+"' must be a function.");else try{e.apply(a,c)}catch(d){f.Log.error("Call AP event handler '"+b[i]+"' failed.",d)}}}function g(a,b,i,c){if(i.description&&("*"===i.description[0]||"!"===i.description[0])){var e=i.description,d=!1;if("!"===e[0]&&(e=f.K1F.trim(e.substr(1)),d=!0,"*"!==e[0]))return{target:c?a:b,ap:i};var g;f.K1F.K1G(e,"*LEFT")&&(g=e.substr(5),
c=!0);f.K1F.K1G(e,"*RIGHT")&&(g=e.substr(6),c=!1);""===g&&(g="*");g&&"."===g[0]&&(g=g.substr(1));if(g){d&&(g="!"+g);var e={},h;for(h in i)i.hasOwnProperty(h)&&(e[h]=i[h]);e.description=g;i=e}}return{target:c?a:b,ap:i}}function h(a){return a.options&&a.options.readonly?(a=a.options.readonly.toLowerCase(),"1"===a||"true"===a):!1}var f=j.Knot.K1M(),e=[],d=[],c=[];f.K3={K4:function(a,b){if(b&&"!"===b[0])return this.K5(a,b)||f.K2;for(var i=
e.length-1;0<=i;i--)if(e[i].doesSupport(a,b))return e[i];return f.K2},K5:function(a,b){for(var i=d.length-1;0<=i;i--)if(d[i].doesSupport(a,b))return d[i];return null},registerAPProvider:function(a,b,i){if(b)0>d.indexOf(a)&&d.push(a);else{0>e.indexOf(a)&&e.push(a);i&&c.push(a);for(a=0;a<c.length;a++)e.splice(e.indexOf(c[a]),1),e.push(c[a])}},unregisterAPProvider:function(a,b){b?0<=d.indexOf(a)&&d.splice(e.indexOf(a),1):(0<=e.indexOf(a)&&e.splice(e.indexOf(a),1),c.indexOf(a)&&
c.splice(c.indexOf(a),1))},K8:{},K9:function(a,b){this.KD(a,b);var i=b.provider.getValue(a,b.description,b.options);try{if(b.pipes){for(var c=0;c<b.pipes.length;c++){var e=f.K1F.getValueOnPath(a,b.pipes[c]);"function"!==typeof e&&f.Log.error("Pipe must be a function. pipe name:"+b.pipes[c]);i=e.apply(a,[i])}b.errorAPProvider&&b.errorAPProvider.setValue(a,"!"+b.description,void 0,b.options);f.Debugger.errorStatusChanged(a,b,void 0)}}catch(d){return b.errorAPProvider&&
(b.errorAPProvider.setValue(a,"!"+b.description,d,b.options),f.Debugger.errorStatusChanged(a,b,d)),this.K8}return i},KA:function(a,b,i,c){if(!b.KB){b.KB=!0;try{this.KD(a,b),b.provider.setValue(a,b.description,i,b.options,c),k(a,b.options,"@set",[b.description,i])}finally{delete b.KB}}},KC:function(a,b,i,c,e){f.Debugger.knotChanged(a,b,i,c,e)},KD:function(a,b){b.provider||(b.provider=this.K4(a,
b.description),b.errorAPProvider=this.K5(a,b.description))},monitor:function(a,b,i,c,e){this.KD(a,b);this.KD(i,c);b.provider.doesSupportMonitoring(a,b.description)&&(b.changedCallback=function(d,g,h,m){if(!c.KB){var n=f.K3.K9(a,b);if(n!==f.K3.K8){e.leftAP===b?f.K3.KC(a,i,e,n,!0):f.K3.KC(i,a,e,n,!1);b.KB=!0;try{f.K3.KA(i,
c,n,m)}finally{delete b.KB}k(a,b.options,"@change",arguments)}}},b.provider.monitor(a,b.description,b.changedCallback,b.options))},stopMonitoring:function(a,b){this.KD(a,b);b.changedCallback&&b.provider.doesSupportMonitoring(a,b.description)&&(b.provider.stopMonitoring(a,b.description,b.changedCallback,b.options),delete b.changedCallback)},KE:function(a,b,i,c,e){var d,g,h,m;a.isComposite?(d=a,g=b,h=i,m=c):(d=i,g=c,h=a,m=b);for(a=0;a<d.childrenAPs.length;a++)d.childrenAPs[a].provider=
f.K3.K4(g,d.childrenAPs[a].description);m.provider=f.K3.K4(m,h.description);d.changedCallback=function(a,i,j,t){a=[];for(i=0;i<d.childrenAPs.length;i++){j=f.K3.K9(g,d.childrenAPs[i]);if(j===f.K3.K8)return;a.push(j)}j=a;if(d.nToOnePipes)for(i=0;i<d.nToOnePipes.length;i++){a=f.K1F.getValueOnPath(g,d.nToOnePipes[i]);typeof a!=="function"&&f.Log.error("Pipe must be a function. pipe name:"+d.nToOnePipes[i]);j=
a.apply(g,[j])}f.K3.KC(b,c,e,j,m===c);f.K3.KA(m,h,j,t);k(m,h,"@change",[b,c,e])};for(a=0;a<d.childrenAPs.length;a++)d.childrenAPs[a].provider.doesSupportMonitoring(g,d.childrenAPs[a].description)&&d.childrenAPs[a].provider.monitor(g,d.childrenAPs[a].description,d.changedCallback,d.childrenAPs[a].options);d.changedCallback()},KF:function(a,b,i){var c=g(a,b,i.leftAP,!0),e=g(a,b,i.rightAP,!1),a=c.target,b=e.target,c=c.ap,e=e.ap;if(c.isComposite||e.isComposite)this.KE(c,
a,e,b,i);else{this.KD(a,c);this.KD(b,e);var d;!h(c)||h(c)&&h(e)?(d=this.K9(b,e),d!==this.K8&&(this.KC(a,b,i,d,!1),this.KA(a,c,d))):(d=this.K9(a,c),d!==this.K8&&(this.KC(b,a,i,d,!1),this.KA(b,e,d)));h(e)||this.monitor(a,c,b,e,i);h(c)||this.monitor(b,e,a,c,i)}f.Debugger.knotTied(a,b,i)},KG:function(a,b,c){var e=g(a,b,c.leftAP,!0),d=g(a,b,c.rightAP,!1),
a=e.target,b=d.target,e=e.ap,d=d.ap;if(e.isComposite||d.isComposite){if(e.isComposite?(d=e,e=a):e=b,d.changedCallback)for(var h=0;h<d.childrenAPs.length;h++)d.childrenAPs[h].provider.doesSupportMonitoring(e,d.childrenAPs[h].description)&&d.childrenAPs[h].provider.stopMonitoring(e,d.childrenAPs[h].description,d.changedCallback,d.childrenAPs[h].options)}else this.stopMonitoring(a,e),delete e.changedCallback,this.stopMonitoring(b,d);delete d.changedCallback;f.Debugger.knotUntied(a,b,c)},KH:function(a){a.changedCallback&&
a.changedCallback()}};f.K2={doesSupport:function(){return!0},getValue:function(a,b){"@"===b[0]&&(b=b.substr(1));return f.K1F.getValueOnPath(a,b)},setValue:function(a,b,c){f.K1F.setValueOnPath(a,b,c)},doesSupportMonitoring:function(a){return"object"!==typeof a?!1:!0},monitor:function(a,b,c){b&&"/"===b[0]&&(a=j,b=b.substr(1));b&&"$"===b[0]&&(a=f.KnotVariants,b=b.substr(1));a&&f.KM.monitor(a,b,c)},stopMonitoring:function(a,b,c){b&&"/"===b[0]&&(a=j,b=b.substr(1));b&&"$"===
b[0]&&(a=f.KnotVariants,b=b.substr(1));a&&f.KM.stopMonitoring(a,b,c)}}})(window);(function(j){function k(b,a,c){for(var i=0,e=l.K1F.K1J(a,i,"{","}");null!==e;){i=a.substr(i,e.start-i);i=l.K1F.trim(i);c&&(i=i.split(",").filter(function(b){return b}).map(function(b){b=l.K1F.trim(b);return c.split(",").filter(function(b){return b}).map(function(a){return l.K1F.trim(a)+" "+b}).join(",")}).join(","));b[i]||(b[i]=[]);for(var d=a.substr(e.start+1,e.end-e.start-1),d=l.K1F.K1K(d,";"),f=0;f<d.length;f++){var g=l.K1F.trim(d[f]);g&&(0===g.indexOf("->")?
k(b,g.substr(2),i):(g=l.K18.K1E(g),0>b[i].indexOf(g)&&b[i].push(g)))}0===b[i].length&&delete b[i];i=e.end+1;e=l.K1F.K1J(a,i,"{","}")}}function g(b){var a=null;b.__knot&&b.__knot.cbsOptions&&(a=b.__knot.cbsOptions,delete b.__knot.cbsOptions);if(b.attributes.binding&&b.attributes.binding.value){a||(a=[]);var c=b.attributes.binding.value,c=l.K18.K1E(c),c=c.split(";").map(function(b){return l.K1F.trim(b)}),a=a.concat(c)}if(a)for(c=
0;c<a.length;c++){b.__knot||(b.__knot={options:[]});var i=l.K18.parse(a[c]);0!==i.length&&(b.__knot.options.push(i[0]),e(i[0].leftAP)&&0>o.indexOf(b)&&o.push(b))}if(b.children)for(a=0;a<b.children.length;a++)g(b.children[a])}function h(b){for(var a=0;a<b.length;a++){var c=b[a].scope,i=b[a].CBS,e=void 0,d=void 0;for(d in i)if(l.K1F.K1G(d,"/")){for(var e=d,f=i,h=[],k=0;k<f[e].length;k++)h=h.concat(l.K18.parse(f[e][k]));l.Kh.addGlobalObjectOption(e,h)}else{var j;
try{j=c.querySelectorAll(d)}catch(o){l.Log.warning("Invalid selector:"+d,o);continue}0===j.length&&l.Log.warning("There is no element selected with selector:"+d);for(e=0;e<j.length;e++)f=i[d].slice(0),j[e].__knot||(j[e].__knot={options:[]}),j[e].__knot.cbsOptions&&(f=j[e].__knot.cbsOptions.concat(f)),j[e].__knot.cbsOptions=f}b[a].scope===document?g(document.body):g(b[a].scope)}}function f(b,a){var c=[],i;a||(i={scope:document,CBS:{},isGlobalScope:!0},c.push(i));for(var e=0;e<b.length;e++){var d;var f=
b[e];if(!f||""===f)d=null;else{for(var g=void 0;0<=(g=f.indexOf("/*"));){d=f.indexOf("*/",g);if(0>d)throw Error("Can't find close mark for comment.");f=f.substr(0,g)+f.substr(d+2)}f=f.split("\n");g="";for(d=0;d<f.length;d++)for(var h=f[d].split("\r"),j=0;j<h.length;j++)"//"!==l.K1F.trim(h[j]).substr(0,2)&&(g+=h[j]);d=g}d=l.K1F.trim(d);if(l.K1F.K1G(d,"$private")){f={CBS:{}};d=d.substr(8);g=f;g.HTML||(g.HTML="");for(var h=0,j="",o=l.K1F.K1J(d,h,"<<{{","}}>>");null!==
o;)j+=d.substr(h,o.start-h),g.HTML+=d.substr(o.start+4,o.end-o.start-4),h=o.end+4,o=l.K1F.K1J(d,h,"<<{{","}}>>");h<d.length&&(j+=d.substr(h));d=j;try{f.scope=document.createElement("DIV"),f.scope.innerHTML=f.HTML,delete f.HTML}catch(q){l.Log.error("Load private scope HTML error.",q);continue}k(f.CBS,d);c.push(f)}else a?l.Log.error("Can't load CBS. It must be a private CBS!"):k(i.CBS,d)}return c}function e(b){return"foreach"===b.description||"content"===b.description}function d(b){for(var b=
b.querySelectorAll("*[knot-template], *[knot-template-id]"),a=0;a<b.length;a++){var c;c=b[a].getAttribute("knot-template-id")?b[a].getAttribute("knot-template-id"):"__knot_template_"+q++;l.Kh.Kk[c]=b[a];b[a].__knot_template_id=c}return Array.prototype.slice.apply(b,[0])}function c(b,a){var c;if(!a.options||!a.options.template&&!a.options.templateSelector){if(c=b.children[0],1<b.children.length&&l.Log.warning("More than one child is found within '"+l.KX.KY(b)+
'", only the first will be taken as template and the reset will be removed.'),!c){l.Log.error("Can't find template within '"+l.KX.KY(b)+"'");return}}else{if(a.options.templateSelector)return;var i=a.options.template;if("@"===i[0])return;c=l.Kh.Kk[i];if(!c){l.Log.error("Can't find template with selector'"+i+"'");return}}c.__knot_template_id||l.Log.error("The template node must be marked with 'knot-template'. Current node:'"+l.KX.KY(b)+
"'");a.options||(a.options={});a.options.template=c.__knot_template_id}function a(b){var a=[],i;for(i=0;i<b.length;i++)a=a.concat(d(b[i].scope));for(i=0;i<o.length;i++)for(var f=0;f<o[i].__knot.options.length;f++)e(o[i].__knot.options[f].leftAP)&&c(o[i],o[i].__knot.options[f].leftAP),e(o[i].__knot.options[f].rightAP)&&c(o[i],o[i].__knot.options[f].rightAP);for(i=o.length=0;i<a.length;i++)delete a[i].__knot_template_id,a[i].removeAttribute("knot-template"),a[i].removeAttribute("knot-template-id"),
a[i].parentNode.removeChild(a[i]);for(i=0;i<b.length;i++)b[i].isGlobalScope||0<b[i].scope.children.length&&l.Log.warning("Useless HTML is detected in private scope.")}function b(b){r.push(b);var a=new l.Deferred,i=l.K1F.K1I();i.onreadystatechange=function(){4===i.readyState&&(200===i.status?a.resolve(i.responseText):a.reject(Error("Load CBS script error. url:"+b+" message:"+i.statusText)))};i.open("GET",b,!0);i.send();return a}function i(){for(var a=new l.Deferred,i=j.document.querySelectorAll('script[type="text/cbs"]'),
c=[],d=0,e=function(){if(0===d)try{a.resolve(c)}catch(b){l.Log.error("Initialize failed.  message:"+b.message,b)}},f=0;f<i.length;f++)i[f].src?0<=r.indexOf(i[f].src)||(d++,function(){var a=i[f].src;b(a).done(function(b){c.push(b);d--;e()},function(b){d--;l.Log.error("Load CBS script error. url:"+a,b);e(b)})}()):c.push(i[f].textContent);0===d&&a.resolve(c);return a}var l=j.Knot.K1M(),o=[],q=0,r=[];l.K1Q={loadGlobalScope:function(){var b=new l.Deferred;i().done(function(i){try{var c=
f(i,!1);h(c);a(c);b.resolve()}catch(d){l.Log.error("Initialize failed.  message:"+d.message,d),b.reject(d)}},function(a){b.reject(a)});return b},loadCBSPackage:function(i){var c=new l.Deferred;0<=r.indexOf(i)?c.resolve():b(i).done(function(b){try{var d=f([b],!0);h(d);a(d)}catch(e){l.Log.error("Parse CBS package failed. package file:"+i,e),c.reject(e)}c.resolve()},function(b){c.reject(b)});return c},test:{parseCBSInDocument:i,getScopes:f,Ks:h,Kv:a}}})(window);(function(j){function k(b){c.Kh.K15(b);b.parentNode.removeChild(b);c.Debugger.nodeRemoved(b)}function g(b,a,c){b.children.length===c?b.appendChild(a):b.insertBefore(a,b.children[c])}function h(b,a,d,e){try{var f=c.K1F.getValueOnPath(d,b);if(!f)return c.Log.error("Can't find template selector:"+b),null;var g=f.apply(a,[d,a]);!g&&!e&&c.Log.error("The template selector returns NULL. template selector:"+b);return g}catch(h){return c.Log.error("Call template selector failed. template selector:"+
b,h),null}}function f(b,a,d){if(!d||!d.template&&!d.templateSelector)c.Log.error("No valid template is specified for 'content' access point. current node:"+c.KX.KY(b));else{var e=function(e,f){if(d&&d[f]){var g=c.K1F.getValueOnPath(a,d[f]);try{g.apply(b,[e,a])}catch(h){c.Log.warning("Raise "+f+" event failed.",h)}}},f=d.template,g=!1;d.templateSelector&&(null===a||"undefined"===typeof a||(f=h(d.templateSelector,b,a,!0)),g=!0);var j=b.childNodes[0];if(j){if(!(j.__knot&&
j.__knot.dataContext===a))if(null===a||"undefined"===typeof a||null===f||"undefined"===typeof f)k(j),e(j,"@removed");else if(g||c.Kh.K10(f)?(k(j),j=null,f&&(j=c.Kh.createFromTemplate(f,a,b)),j&&(b.appendChild(j),c.Kh.hasDataContext(j)||c.Kh.setDataContext(j,a),c.Debugger.nodeAdded(j),e(j,"@added"))):c.Kh.setDataContext(j,a),j)j.__knot||(j.__knot={}),j.__knot.dataContext=a}else if(!(null===a||"undefined"===typeof a||null===
f||"undefined"===typeof f))if(f=c.Kh.createFromTemplate(f,a,b))b.appendChild(f),c.Kh.hasDataContext(f)||c.Kh.setDataContext(f,a),e(f,"@added"),c.Debugger.nodeAdded(f)}}function e(b,a,d,e,f,j,p){var m,n;a||(a=[]);if(p){if(b.__knot_latestForeachArrayVersion!==a.__knot_arrayVersion){if(p.removed){var s=p.removed;for(m=s.length-1;0<=m;m--)n=b.children[s[m]],k(n),j&&j.apply(b,[n])}if(p.added){j=p.added;for(m=0;m<j.length;m++){if(e&&(d=h(e,b,a[j[m]]),!d))continue;
if(n=c.Kh.createFromTemplate(d,a[j[m]],b))g(b,n,j[m]),c.Kh.hasDataContext(n)||c.Kh.setDataContext(n,a[j[m]]),c.Debugger.nodeAdded(n),f&&f.apply(b,[n,a[j[m]]])}}b.__knot_latestForeachArrayVersion=a.__knot_arrayVersion}}else{for(m=0;m<a.length;m++){a:{for(n=m;n<b.children.length;n++)if(b.children[n].__knot&&b.children[n].__knot.dataContext===a[m]){n=b.children[n];break a}n=null}if(n)Array.prototype.indexOf.call(b.children,n)!==m&&(b.removeChild(n),g(b,n,m));else{if(e&&
(d=h(e,b,a[m]),!d))continue;if(n=c.Kh.createFromTemplate(d,a[m],b))g(b,n,m),c.Kh.hasDataContext(n)||c.Kh.setDataContext(n,a[m]),c.Debugger.nodeAdded(n),f&&f.apply(b,[n,a[m]])}}for(m=b.children.length-1;m>=a.length;m--)n=b.children[m],k(n),j&&j.apply(b,[n])}}function d(b,a,d,f){!d||!d.template&&!d.templateSelector?c.Log.error("No valid template is specified for 'foreach' access point. current node:"+c.KX.KY(b)):e(b,a,d.template,d.templateSelector,
c.K1F.getValueOnPath(b,d["@added"]),c.K1F.getValueOnPath(b,d["@removed"]),f)}var c=j.Knot.K1M(),a=[];a["input.value"]="change";a["textarea.value"]="change";a["input.checked"]="change";a["select.selectedIndex"]="change";a["select.value"]="change";a["*.clientWith"]="resize";a["*.clientHeight"]="resize";a["*.scrollTop"]="scroll";a["*.scrollLeft"]="scroll";c.KX={KY:function(b){var a=b.tagName;b.id?a+="[#"+b.id+"]":b.className&&(a+="["+b.className.split(" ").filter(function(b){return b.trim()!==
""}).map(function(b){return"."+b}).join(" ")+"]");return a},getSelectorFromAPDescription:function(b){b=c.K1F.K1K(b,".");return c.K1F.trim(b[0])},getPropertyNameFromAPDescription:function(b){b=c.K1F.K1K(b,".");if(1<b.length)return b.slice(1).join(".")},getPropertyFromElement:function(b,a){return!b?void 0:c.K1F.getValueOnPath(b,a)},Kd:function(b){if(0<b.indexOf("(")){var a=c.K1F.K1J(b,0,"(",")");if(a)try{var d=b.substr(a.start+1,
a.end-a.start-1);return document.querySelector(d)}catch(e){c.Log.error("Query selector failed.",e)}else c.Log.error("Unknown selector:"+b)}else return document.querySelector(b)}};c.Kf={doesSupport:function(b,a){return"#"===a[0]?!0:"!"===a[0]?!1:b instanceof HTMLElement},getValue:function(b,a){if("@"!==a[0]&&("#"===a[0]&&(b=c.KX.Kd(c.KX.getSelectorFromAPDescription(a)),a=c.KX.getPropertyNameFromAPDescription(a)),!c.K1F.K1G(a,"content")&&
!c.K1F.K1G(a,"foreach")))return c.KX.getPropertyFromElement(b,a)},setValue:function(b,a,e,g,h){"@"===a[0]?"function"!==typeof e?c.Log.error("Event listener must be a function!"):b&&b.addEventListener(a.substr(1),function(a){e.apply(b.__knot.dataContext,[a,b])}):("#"===a[0]&&(b=c.KX.Kd(c.KX.getSelectorFromAPDescription(a)),a=c.KX.getPropertyNameFromAPDescription(a)),c.K1F.K1G(a,"content"))?f(b,e,g):c.K1F.K1G(a,"foreach")?
d(b,e,g,h):("undefined"===typeof e&&(e=""),c.K1F.setValueOnPath(b,a,e))},doesSupportMonitoring:function(b,d){"#"===d[0]&&(b=c.KX.Kd(c.KX.getSelectorFromAPDescription(d)),d=c.KX.getPropertyNameFromAPDescription(d));if(!b)return!1;var e=b.tagName.toLowerCase()+"."+d;return a[e]||a["*."+d]},monitor:function(b,d,e,f){"#"===d[0]&&(b=c.KX.Kd(c.KX.getSelectorFromAPDescription(d)),d=c.KX.getPropertyNameFromAPDescription(d));
for(var d=b.tagName.toLowerCase()+"."+d,d=a[d].split(","),g=0;g<d.length;g++)b.addEventListener(d[g],e);("input"===b.tagName.toLowerCase()||"textarea"===b.tagName.toLowerCase())&&(f&&f.immediately&&("1"===f.immediately||"true"===f.immediately.toLowerCase()))&&b.addEventListener("keyup",e)},stopMonitoring:function(b,d,e,f){"#"===d[0]&&(b=c.KX.Kd(c.KX.getSelectorFromAPDescription(d)),d=c.KX.getPropertyNameFromAPDescription(d));for(var d=b.tagName.toLowerCase()+
"."+d,d=a[d].split(","),g=0;g<d.length;g++)b.removeEventListener(d[g],e);("input"===b.tagName.toLowerCase()||"textarea"===b.tagName.toLowerCase())&&(f&&f.immediately&&("1"===f.immediately||"true"===f.immediately.toLowerCase()))&&b.removeEventListener("keyup",e)},syncItems:e};c.K3.registerAPProvider(c.Kf);c.Kg={doesSupport:function(b,a){return a&&("!"===a[0]&&(a=a.substr(1)),"#"===a[0])?!0:b instanceof HTMLElement},getValue:function(b,a){if("!"===a[0]&&(a=a.substr(1),
"#"===a[0]&&(b=c.KX.Kd(c.KX.getSelectorFromAPDescription(a)),a=c.KX.getPropertyNameFromAPDescription(a)),b))return!b.__knot_errorStatusInfo||!b.__knot_errorStatusInfo[a]?null:b.__knot_errorStatusInfo[a].currentStatus},setValue:function(b,a,d,e){if("!"===a[0]&&(a=a.substr(1),"#"===a[0]&&(b=c.KX.Kd(c.KX.getSelectorFromAPDescription(a)),a=c.KX.getPropertyNameFromAPDescription(a)),b&&(d||b.__knot_errorStatusInfo&&b.__knot_errorStatusInfo[a]&&
b.__knot_errorStatusInfo[a].K1O)))if(b.__knot_errorStatusInfo||(b.__knot_errorStatusInfo={}),b.__knot_errorStatusInfo[a]||(b.__knot_errorStatusInfo[a]={}),b.__knot_errorStatusInfo[a].currentStatus!==d){b.__knot_errorStatusInfo[a].currentStatus=d;if(b.__knot_errorStatusInfo[a].K1O)for(var f=b.__knot_errorStatusInfo[a].K1O,g=0;g<f.length;g++)try{f[g].apply(b,[a,d])}catch(h){c.Log.warning("Call error status changed callback failed.",h)}if(e&&e["@error"])if(f=c.K1F.getValueOnPath(null,
e["@error"]),!f||"function"!==typeof f)c.Log.error("'"+e["@error"]+"' must be a function.");else try{f.apply(b,[a,d])}catch(j){c.Log.error("Call AP error event handler '"+e["@error"]+"' failed.",j)}}},doesSupportMonitoring:function(b,a){return"!"===a[0]},monitor:function(b,a,d){if("!"===a[0]){a=a.substr(1);if("#"===a[0]){var e=c.KX.getSelectorFromAPDescription(a),b=c.KX.Kd(e);if(!b){c.Log.warning("Failed to bind to error status, target is not found.  target selector:"+
e);return}a=c.KX.getPropertyNameFromAPDescription(a)}b.__knot_errorStatusInfo||(b.__knot_errorStatusInfo={});b.__knot_errorStatusInfo[a]||(b.__knot_errorStatusInfo[a]={});b.__knot_errorStatusInfo[a].K1O||(b.__knot_errorStatusInfo[a].K1O=[]);b.__knot_errorStatusInfo[a].K1O.push(d)}},stopMonitoring:function(b,a,d){"#"===a[1]&&(b=c.KX.Kd(c.KX.getSelectorFromAPDescription(a.substr(1))),a=c.KX.getPropertyNameFromAPDescription(a.substr(1)));
b.__knot_errorStatusInfo&&(b.__knot_errorStatusInfo[a]&&b.__knot_errorStatusInfo[a].K1O)&&(d=b.__knot_errorStatusInfo[a].K1O.indexOf(d),0<=d&&b.__knot_errorStatusInfo[a].K1O.splice(d,1))},getErrorStatusInformation:function(a,d){if(a.__knot_errorStatusInfo)for(var c in a.__knot_errorStatusInfo)a.__knot_errorStatusInfo[c]&&a.__knot_errorStatusInfo[c].currentStatus&&d.push({node:a,accessPointName:c,error:a.__knot_errorStatusInfo[c].currentStatus});for(c=0;c<a.children.length;c++)this.getErrorStatusInformation(a.children[c],
d)}};c.K3.registerAPProvider(c.Kg,!0)})(window);(function(j){function k(a){if(!a)return null;for(var b=0;b<a.length;b++)if("dataContext"===a[b].leftAP.description)return a[b];return null}function g(a,b){a.__knot?b.__knot=JSON.parse(JSON.stringify(a.__knot)):delete b.__knot;for(var d=0;d<a.children.length;d++)g(a.children[d],b.children[d])}function h(){var a,b;for(b in d){(function(){var c=b;d[c].objectObserveCallback=function(b,f,g){b=d[c].options;if(f)for(a=0;a<b.length;a++)e.K3.KG(f,null,b[a]);for(a=0;a<b.length;a++)e.K3.KF(g,
null,b[a])};e.KM.monitor(j,b.substr(1),d[c].objectObserveCallback)})();var c=e.K1F.getValueOnPath(null,b);if(c){var f=d[b].options;for(a=0;a<f.length;a++)e.K3.KF(c,null,f[a])}}}function f(a,b){a.__knot_component||(c[b]?a.__knot_component=c[b](a,b):e.Log.error("Component '"+b+"' is not registered."))}var e=j.Knot.K1M(),d={},c={};e.Kh={Kk:{},addGlobalObjectOption:function(a,b){d[a]||(d[a]={options:[]});d[a].options=d[a].options.concat(b)},
K10:function(a){return"function"===typeof a||!this.Kk[a]},createFromTemplate:function(a,b,d){if(this.K10(a)){var c,f;f="function"===typeof a?a:e.K1F.getValueOnPath(b,a);"function"===typeof f?c=f.apply(d,[b]):e.Log.error("Unknown template:"+a);return c}e.Kh.Kk[a]?(a=e.Kh.Kk[a],b=a.cloneNode(!0),g(a,b),a=b):(e.Log.error("Failed find template. id:"+a),a=void 0);return a},hasDataContext:function(a){return a.__knot&&"dataContext"in
a.__knot},setDataContext:function(a,b){this.K13(a,b,!0);a.__knot?a.__knot.dataContext=b:a.__knot={dataContext:b};a.__knot.isFixedDataContext=!0},K11:function(a){if(a.__knot&&a.__knot.options)for(var b=0;b<a.__knot.options.length;b++)"dataContext"!==a.__knot.options[b].leftAP.description&&e.K3.KG(a,a.__knot.dataContext,a.__knot.options[b])},K12:function(a){if(a.__knot&&a.__knot.options)for(var b=0;b<a.__knot.options.length;b++)"dataContext"!==a.__knot.options[b].leftAP.description&&
e.K3.KF(a,a.__knot.dataContext,a.__knot.options[b])},K13:function(a,b,d){if(a instanceof HTMLElement||a instanceof HTMLBodyElement){var c;a.getAttribute("knot-component")&&f(a,a.getAttribute("knot-component"));if(a.__knot){if(d||!a.__knot.isFixedDataContext){c=k(a.__knot.options);d=b;if(c){d=e.K3.K9(b,c.rightAP);if(d===e.K3.K8){e.Log.error("Get context data failed. node:"+e.KX.KY(a));return}if(c.hasTiedUpKnot&&
d===a.__knot.dataContext)return;(c.data||"/"===c.rightAP.description[0])&&c.changedCallback&&c.rightAP.provider.stopMonitoring(c.data,c.rightAP.description,c.changedCallback,c.rightAP.options);c.data=b;c.data||"/"===c.rightAP.description[0]?(c.changedCallback=function(){e.Kh.K13(a,b)},c.rightAP.provider.monitor(c.data,c.rightAP.description,c.changedCallback,c.rightAP.options)):c.changedCallback=null;c.hasTiedUpKnot=!0}this.K11(a);e.K3.KC(a,
b,c,d,!1);for(c=0;c<a.childNodes.length;c++)this.K13(a.childNodes[c],d);a.__knot.dataContext=d;this.K12(a)}}else for(c=0;c<a.childNodes.length;c++)this.K13(a.childNodes[c],b)}},K14:function(a){for(;a;){if(a.__knot)return a.__knot.dataContext;a=a.parentNode}},K15:function(a){if(a.__knot){var b=k(a.__knot.options);b&&((b.data||"/"===b.rightAP.description[0])&&b.changedCallback&&b.rightAP.provider.stopMonitoring(b.data,b.rightAP.description,
b.changedCallback,b.rightAP.options),b.data=null,b.changedCallback=null,b.hasTiedUpKnot=!1);this.K11(a);delete a.__knot.dataContext}a.__knot_component&&(a.__knot_component.dispose&&a.__knot_component.dispose(),delete a.__knot_component);for(b=0;b<a.childNodes.length;b++)this.K15(a.childNodes[b])},bind:function(){h();this.K13(document.body,null)},clear:function(a){if(!a){var b,c;for(c in d){d[c].objectObserveCallback&&e.KM.stopMonitoring(j,c.substr(1),d[c].objectObserveCallback);
var f=e.K1F.getValueOnPath(null,c);if(f){var g=d[c].options;for(b=0;b<g.length;b++)e.K3.KG(f,null,g[b])}}}this.K15(a||document.body)},K16:function(a,b){a.__knot||(a.__knot={});a.__knot.dataContext=b},K1L:function(a){if(a.__knot)return a.__knot.dataContext},K17:function(a){var b;if(a.__knot&&a.__knot.options)for(b=0;b<a.__knot.options.length;b++)"dataContext"!==a.__knot.options[b].leftAP.description&&!(a.__knot.options[b].leftAP.description&&
"!"===a.__knot.options[b].leftAP.description[0])&&e.K3.KH(a.__knot.options[b].leftAP);for(b=0;b<a.children.length;b++)this.K17(a.children[b])},registerComponent:function(a,b){if(c[a])throw Error("Component '"+a+"' has been registered!");c[a]=b},getComponentObject:function(a){return a.__knot_component}}})(window);(function(j){function k(d,c,a,b){b=f.K18.parse(c+":"+b);0<b.length?(f.K3.KF(d,a,b[0]),d.__knot.options||(d.__knot.options=[]),d.__knot.options.push(b[0])):d[c]=a;return b}function g(d){var c=d.tagName.toLowerCase();"input"===c&&(c+=d.type.toLocaleLowerCase());return c}function h(d){if(d=d.options[d.selectedIndex])return d.__knot?d.__knot.dataContext:void 0}var f=j.Knot.K1M(),e={text:{"input.text":"value",textarea:"value",option:"text",span:"textContent","*":"textContent"}};
f.K3.registerAPProvider({doesSupport:function(d,c){"#"===c[0]&&(d=f.KX.Kd(f.KX.getSelectorFromAPDescription(c)),c=f.KX.getPropertyNameFromAPDescription(c));return d instanceof HTMLElement&&("select"===d.tagName.toLowerCase()&&(f.K1F.K1G(c,"options")||"selectedData"===c||f.K1F.K1G(c,"selectedData.")||"value"===c)||"class"===c||e[c])?!0:!1},getValue:function(d,c){"#"===c[0]&&(d=f.KX.Kd(f.KX.getSelectorFromAPDescription(c)),
c=f.KX.getPropertyNameFromAPDescription(c));if("select"===d.tagName.toLowerCase()&&("selectedData"===c||f.K1F.K1G(c,"selectedData.")))return"selectedData"===c?h(d):f.K1F.getValueOnPath(h(d),c.split(".").slice(1).join("."));if("select"===d.tagName.toLowerCase()&&"value"===c)return 0<=d.selectedIndex?d.options[d.selectedIndex].value:void 0;if("class"===c)return d.className;if("select"===d.tagName.toLowerCase()&&f.K1F.K1G(c,"options"))return d.options;if(e[c]){var a;
a=d;var b=c,i=g(a);a=e[b][i]?a[e[b][i]]:a[e[b]["*"]];return a}},setValue:function(d,c,a,b){"#"===c[0]&&(d=f.KX.Kd(f.KX.getSelectorFromAPDescription(c)),c=f.KX.getPropertyNameFromAPDescription(c));if("class"===c){if(a){for(var b=[],c=d.className.split(" "),a=a.split(" "),i=0;i<a.length;i++){var j=a[i];"-"===j[0]?(j=j.substr(1).trim(),0<=c.indexOf(j)&&c.splice(c.indexOf(j),1)):"+"===j[0]?(j=j.substr(1).trim(),0>c.indexOf(j)&&c.push(j)):b.push(j)}d.className=0<
b.length?b.join(" "):c.join(" ")}}else if("select"===d.tagName.toLowerCase()&&"value"===c){for(b=0;b<d.options.length;b++)if(d.options[b].value===a){d.selectedIndex=b;return}d.selectedIndex=-1}else if("select"===d.tagName.toLowerCase()&&("selectedData"===c||f.K1F.K1G(c,"selectedData.")))if("selectedData"===c)a:{for(b=0;b<d.options.length;b++)if(d.options[b].__knot&&d.options[b].__knot.dataContext===a){d.selectedIndex=b;break a}d.selectedIndex=-1}else f.K1F.setValueOnPath(h(d),c.split(".").slice(1).join("."));
else if("select"===d.tagName.toLowerCase()&&f.K1F.K1G(c,"options")){(c=b)||(c={});a||(a=[]);for(b=0;b<a.length;b++){a:{for(var i=d.options,j=a[b],o=b;o<i.length;o++)if(f.Kh.K1L(i[o])===j){i=i[o];break a}i=null}i?d.options[b].indexOf(i)!==b&&(d.options.remove(d.options[b].indexOf(i)),d.options.add(i,b)):(i=document.createElement("option"),f.Kh.K16(i,a[b]),a[b]&&(c.displayMember?k(i,"text",a[b],c.displayMember):i.text=a[b],c.valueMember?
k(i,"value",a[b],c.valueMember):i.value=a[b]),d.options.add(i,b))}for(b=d.options.length-1;b>=a.length;b--){c=d.options[b];if(c.__knot&&c.__knot.options){for(i=0;i<c.__knot.options.length;i++)f.K3.KG(c,c.__knot.dataContext,c.__knot.options[i]);delete c.__knot.dataContext}d.options.remove(b)}}else e[c]&&(b=c,"undefined"===typeof a&&(a=""),c=g(d),e[b][c]?d[e[b][c]]=a:d[e[b]["*"]]=a)},doesSupportMonitoring:function(d,c){"#"===c[0]&&(d=f.KX.Kd(f.KX.getSelectorFromAPDescription(c)),
c=f.KX.getPropertyNameFromAPDescription(c));return d&&"select"===d.tagName.toLowerCase()&&("selectedData"===c||f.K1F.K1G(c,"selectedData.")||"value"===c)},monitor:function(d,c,a){"#"===c[0]&&(d=f.KX.Kd(f.KX.getSelectorFromAPDescription(c)),c=f.KX.getPropertyNameFromAPDescription(c));"select"===d.tagName.toLowerCase()&&("selectedData"===c||f.K1F.K1G(c,"selectedData.")||"value"===c)&&d.addEventListener("change",a)},stopMonitoring:function(d,
c,a){"#"===c[0]&&(d=f.KX.Kd(f.KX.getSelectorFromAPDescription(c)),c=f.KX.getPropertyNameFromAPDescription(c));"select"===d.tagName.toLowerCase()&&("selectedData"===c||f.K1F.K1G(c,"selectedData.")||"value"===c)&&d.removeEventListener("change",a)}})})(window);(function(j){j.Knot.K1M().K3.registerAPProvider({doesSupport:function(j){return j&&j.__knot_component},getValue:function(j,g,h){return j.__knot_component.getValue(g,h)},setValue:function(j,g,h,f){j.__knot_component.setValue(g,h,f)},doesSupportMonitoring:function(j,g){return j.__knot_component.doesSupportMonitoring(g)},monitor:function(j,g,h,f){j.__knot_component.monitor(g,h,f)},stopMonitoring:function(j,g,h,f){j.__knot_component.stopMonitoring(g,h,f)}},!1,!0)})(window);(function(j){function k(){if(!d){d=!0;try{if(f){for(var a=f.map(function(a){return h.K1F.getValueOnPath(null,"$hash."+a)}),b=a.length-1;0<=b&&!a[b];b--)a.length=b;b="";0<a.length&&(b=a.join(e));j.location.hash="#"+b;h.K1F.setValueOnPath(null,"$hash.originalHash",b)}}finally{d=!1}}}function g(){if(!d){d=!0;try{var a;a=j.location.hash?j.location.hash.substr(1):"";if(f)for(var b=h.K1F.K1K(a,e),c=0;c<f.length;c++)h.K1F.setValueOnPath(null,"$hash."+f[c],b[c]);h.K1F.setValueOnPath(null,
"$hash.originalHash",a)}finally{d=!1}}}var h=j.Knot.K1M(),f,e,d=!1;h.K1F.setValueOnPath(null,"$hash",{});var c=h.K1F.getValueOnPath(null,"$hash");g();h.K1P={setHashFormat:function(a,b){if(!(a instanceof Array))throw Error("Hash fields must be an array.");if(0<=a.indexOf("hash"))throw Error("Hash field can't be 'hash'.");if(!b)throw Error("Please specify the splitter.");var d;if(f)for(d=0;d<f.length;d++)h.KM.stopMonitoring(c,f[d],k);f=a;e=b;if(f)for(d=0;d<
f.length;d++)h.KM.monitor(c,f[d],k);g()}};h.KM.monitor(c,"originalHash",function(){j.location.hash="#"+c.originalHash;g()});j.addEventListener("hashchange",function(){g()})})(window);(function(j){function k(){var e;for(e=0;e<h.length;e++)try{if(f)h[e](!1,f);else h[e](!0)}catch(d){g.Log.warning("Execute on ready callback failed.",d)}h.length=0}var g=j.Knot.K1M();delete j.Knot.K1M;j.Knot.Advanced={registerAPProvider:function(e){return g.K3.registerAPProvider(e)},registerLogger:function(e){g.Log.log=e},registerDebugger:function(e){g.Debugger=e},synchronizeItems:function(e,d,c,a,b){g.Kf.syncItems(e,d,c,a,b)},createFromTemplate:function(e,
d,c){return g.Kh.createFromTemplate(e,d,c)},setDataContext:function(e,d){g.Kh.setDataContext(e,d)},getValueOnPath:function(e,d){return g.K1F.getValueOnPath(e,d)},registerNamedGlobalSymbol:function(e,d){return g.KS.KT(e,d)},registerComponent:function(e,d){return g.Kh.registerComponent(e,d)},getComponentObject:function(e){return g.Kh.getComponentObject(e)}};j.Knot.getErrorStatusInformation=function(e){e||(e=document.body);
g.Kh.K17(e);var d=[];g.Kg.getErrorStatusInformation(e,d);return d};j.Knot.notifyObjectChanged=function(e,d,c,a,b){g.KM.notifyDataChanged(e,d,c,a,b)};j.Knot.monitorObject=function(e,d,c){g.KM.monitorObject(e,d,c)};j.Knot.stopMonitoringObject=function(e,d,c){g.KM.stopMonitoring(e,d,c)};j.Knot.getPropertiesChangeRecords=function(e){return g.KM.getPropertiesChangeRecords(e)};j.Knot.clearPropertiesChangeRecords=function(e){return g.KM.clearPropertiesChangeRecords(e)};
j.Knot.clear=function(e){g.Kh.clear(e)};j.Knot.getDataContext=function(e){return g.Kh.K14(e)};j.Knot.findElementBindToData=function(e,d){for(var c=0;c<e.length;c++)if(j.Knot.getDataContext(e[c])===d)return e};j.Knot.setHashFormat=function(e,d){g.K1P.setHashFormat(e,d)};j.Knot.getKnotVariant=function(e){return g.K1F.getValueOnPath(null,e)};j.Knot.setKnotVariant=function(e,d){return g.K1F.setValueOnPath(null,e,d)};var h=[],f;j.Knot.ready=
function(e){h.push(e);(j.Knot.isReady||f)&&k()};j.Knot.isReady=!1;j.addEventListener("load",function(){g.K1Q.loadGlobalScope().done(function(){g.Kh.bind();j.Knot.isReady=!0;f=null;k()},function(e){j.Knot.isReady=!1;f=e;k()})})})(window);
